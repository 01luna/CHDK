/*
 * capt_seq.c - auto-generated by CHDK code_gen.
 */
#include "lolevel.h"
#include "platform.h"
#include "core.h"

static long *nrflag = (long*)0x6E50;

#include "../../../generic/capt_seq.c"

/*************************************************************/
//** capt_seq_task @ 0xFF99F3B0 - 0xFF99F5DC, length=140
void __attribute__((naked,noinline)) capt_seq_task() {
asm volatile (
"    STMFD   SP!, {R4,R5,LR} \n"
"    SUB     SP, SP, #4 \n"
"    MOV     R5, SP \n"
"    B       loc_FF99F5A8 \n"

"loc_FF99F3C0:\n"
"    LDR     R2, [SP] \n"
"    LDR     R3, [R2] \n"
"    MOV     R0, R2 \n"
"    CMP     R3, #0x19 \n"
"    LDRLS   PC, [PC, R3, LSL#2] \n"
"    B       loc_FF99F57C \n"
"    .long   loc_FF99F440 \n"
"    .long   loc_FF99F460 \n"
"    .long   loc_FF99F474 \n"
"    .long   loc_FF99F488 \n"
"    .long   loc_FF99F480 \n"
"    .long   loc_FF99F490 \n"
"    .long   loc_FF99F498 \n"
"    .long   loc_FF99F4A4 \n"
"    .long   loc_FF99F4AC \n"
"    .long   loc_FF99F4B8 \n"
"    .long   loc_FF99F4C0 \n"
"    .long   loc_FF99F4C8 \n"
"    .long   loc_FF99F4D0 \n"
"    .long   loc_FF99F4D8 \n"
"    .long   loc_FF99F4E0 \n"
"    .long   loc_FF99F4EC \n"
"    .long   loc_FF99F4F4 \n"
"    .long   loc_FF99F4FC \n"
"    .long   loc_FF99F504 \n"
"    .long   loc_FF99F510 \n"
"    .long   loc_FF99F51C \n"
"    .long   loc_FF99F524 \n"
"    .long   loc_FF99F564 \n"
"    .long   loc_FF99F56C \n"
"    .long   loc_FF99F574 \n"
"    .long   loc_FF99F590 \n"

"loc_FF99F440:\n"
"    BL      sub_FF99FAE8 \n"

// only do quick press hack if overrides are active
"    BL      captseq_hack_override_active\n" // returns 1 if tv or sv override in effect
"    STR     R2, [SP,#-4]!\n" // push return value
"    BL      shooting_expo_param_override\n"   // +

"    BL      sub_FF99CC60 \n"
"    LDR     R3, =0xA4840 \n"

"    LDR     R2, [SP], #4\n" // pop override hack
"    CMP     R2, #1\n"     // +
"    MOVEQ   R2, #0\n"     // +
"    STREQ   R2, [R3, #0x28]\n"  // fixes overrides behavior at short shutter press
"    LDRNE   R2, [R3, #0x28]\n" // modified NE
"    CMPNE   R2, #0\n"         // modified NE

//"  LDR     R2, [R3, #0x28] \n"  // above patch makes these lines redundant
//"  CMP     R2, #0 \n"
"    BEQ     loc_FF99F58C \n"
"    BL      sub_FF99EF7C_my \n"  // --> Patched. Old value = 0xFF99EF7C.
"    B       loc_FF99F58C \n"

"loc_FF99F460:\n"
"    BL      sub_FF99ED38_my \n"  // --> Patched. Old value = 0xFF99ED38.

"loc_FF99F464:\n"
"    LDR     R2, =0xA4840 \n"
"    MOV     R3, #0 \n"
"    STR     R3, [R2, #0x28] \n"
"    B       loc_FF99F58C \n"

"loc_FF99F474:\n"
"    MOV     R0, #1 \n"
"    BL      sub_FF99FDA8 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F480:\n"
"    BL      sub_FF99F6A4 \n"
"    B       loc_FF99F464 \n"

"loc_FF99F488:\n"
"    BL      sub_FF99FAA0 \n"
"    B       loc_FF99F464 \n"

"loc_FF99F490:\n"
"    BL      sub_FF99FAB0 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F498:\n"
"    BL      sub_FF99FC48 \n"
"    BL      sub_FF99CC60 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F4A4:\n"
"    BL      sub_FF99F060 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F4AC:\n"
"    BL      sub_FF99FCFC \n"
"    BL      sub_FF99CC60 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F4B8:\n"
"    BL      sub_FF99FAA0 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F4C0:\n"
"    BL      sub_FF9A16F4 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F4C8:\n"
"    BL      sub_FF9A1938 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F4D0:\n"
"    BL      sub_FF9A19F0 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F4D8:\n"
"    BL      sub_FF9A1A8C \n"
"    B       loc_FF99F58C \n"

"loc_FF99F4E0:\n"
"    MOV     R0, #0 \n"
"    BL      sub_FF9A1F14 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F4EC:\n"
"    BL      sub_FF9A2120 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F4F4:\n"
"    BL      sub_FF9A21B8 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F4FC:\n"
"    BL      sub_FF9A2278 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F504:\n"
"    MOV     R0, #1 \n"
"    BL      sub_FF9A1F14 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F510:\n"
"    BL      sub_FF99FF7C \n"
"    BL      sub_FF99EAF8 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F51C:\n"
"    BL      sub_FF9A1D9C \n"
"    B       loc_FF99F58C \n"

"loc_FF99F524:\n"
"    LDR     R4, =0xA48A0 \n"
"    MOV     R0, #0x11 \n"
"    MOV     R1, R4 \n"
"    MOV     R2, #2 \n"
"    BL      _GetPropertyCase \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF99F550 \n"
"    MOV     R1, #0x4C0 \n"
"    LDR     R0, =0xFF99E838 /*'ShootTask.c'*/ \n"
"    ADD     R1, R1, #6 \n"
"    BL      _DebugAssert \n"

"loc_FF99F550:\n"
"    LDRH    R3, [R4] \n"
"    CMP     R3, #1 \n"
"    BNE     loc_FF99F58C \n"
"    BL      sub_FF9A1D88 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F564:\n"
"    BL      sub_FF9A1E34 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F56C:\n"
"    BL      sub_FF99EC18 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F574:\n"
"    BL      sub_FF99BA04 \n"
"    B       loc_FF99F58C \n"

"loc_FF99F57C:\n"
"    MOV     R1, #0x4E0 \n"
"    LDR     R0, =0xFF99E838 /*'ShootTask.c'*/ \n"
"    ADD     R1, R1, #7 \n"
"    BL      _DebugAssert \n"

"loc_FF99F58C:\n"
"    LDR     R2, [SP] \n"

"loc_FF99F590:\n"
"    LDR     R3, =0x77BB4 \n"
"    LDR     R1, [R2, #4] \n"
"    LDR     R0, [R3] \n"
"    BL      sub_FF820CE0 /*_SetEventFlag*/ \n"
"    LDR     R0, [SP] \n"
"    BL      sub_FF99E928 \n"

"loc_FF99F5A8:\n"
"    LDR     R3, =0x77BB8 \n"
"    MOV     R1, R5 \n"
"    LDR     R0, [R3] \n"
"    MOV     R2, #0 \n"
"    BL      sub_FF8213F8 /*_ReceiveMessageQueue*/ \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF99F3C0 \n"
"    MOV     R1, #0x410 \n"
"    LDR     R0, =0xFF99E838 /*'ShootTask.c'*/ \n"
"    ADD     R1, R1, #9 \n"
"    BL      _DebugAssert \n"
"    BL      _ExitTask \n"
"    ADD     SP, SP, #4 \n"
"    LDMFD   SP!, {R4,R5,PC} \n"
);
}

/*************************************************************/
//** sub_FF99EF7C_my @ 0xFF99EF7C - 0xFF99F058, length=56
void __attribute__((naked,noinline)) sub_FF99EF7C_my() {
asm volatile (
"    STMFD   SP!, {R4,LR} \n"
"    BL      sub_FF99E724 \n"
"    LDR     R3, =0xA4840 \n"
"    LDR     R2, [R3, #0x28] \n"
"    CMP     R2, #0 \n"
"    MOV     R4, R0 \n"
"    MOV     R0, #0xC \n"
"    BEQ     loc_FF99EFC4 \n"
"    BL      sub_FF9AA0F8 \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF99EFC4 \n"
"    LDR     R3, [R4, #8] \n"
"    LDR     R2, =0x6E20 \n"
"    ORR     R3, R3, #0x40000000 \n"
"    MOV     R1, #1 \n"
"    STR     R1, [R2] \n"
"    STR     R3, [R4, #8] \n"
"    LDMFD   SP!, {R4,PC} \n"

"loc_FF99EFC4:\n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A2578 \n"
"    BL      sub_FF9E6FCC \n"
"    BL      sub_FF825AD0 \n"
"    STR     R0, [R4, #0x14] \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A2B40_my \n"  // --> Patched. Old value = 0xFF9A2B40.
"    BL      capt_seq_hook_raw_here\n"   // +
"    TST     R0, #1 \n"
"    LDRNE   R3, =0x6E20 \n"
"    MOVNE   R2, #1 \n"
"    STRNE   R2, [R3] \n"
"    LDMFD   SP!, {R4,PC} \n"
);
}

/*************************************************************/
//** sub_FF99ED38_my @ 0xFF99ED38 - 0xFF99EF6C, length=142
void __attribute__((naked,noinline)) sub_FF99ED38_my() {
asm volatile (
"    STMFD   SP!, {R4,R5,LR} \n"
"    LDR     R3, =0xA4840 \n"
"    LDR     R4, [R0, #0xC] \n"
"    LDR     R1, [R3, #0x28] \n"
"    LDR     R2, [R4, #8] \n"
"    CMP     R1, #0 \n"
"    ORR     R2, R2, #1 \n"
"    STR     R2, [R4, #8] \n"
"    BNE     loc_FF99ED8C \n"
"    MOV     R0, #0xC \n"
"    BL      sub_FF9AA0F8 \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF99ED8C \n"
"    LDR     R3, [R4, #8] \n"
"    MOV     R0, #1 \n"
"    ORR     R3, R3, #0x40000000 \n"
"    STR     R3, [R4, #8] \n"

"loc_FF99ED7C:\n"
"    MOV     R2, R4 \n"
"    MOV     R1, #1 \n"
"    LDMFD   SP!, {R4,R5,LR} \n"
"    B       sub_FF99D200 \n"

"loc_FF99ED8C:\n"
"    LDR     R1, =0xA4840 \n"
"    MOV     R3, #0x8200 \n"
"    LDRH    R2, [R1] \n"
"    ADD     R3, R3, #0xA \n"
"    CMP     R2, R3 \n"
"    BEQ     loc_FF99EDD8 \n"
"    LDRH    R3, [R1, #0x90] \n"
"    CMP     R3, #3 \n"
"    BEQ     loc_FF99EDD8 \n"
"    LDR     R3, [R4, #0xC] \n"
"    CMP     R3, #1 \n"
"    BLS     loc_FF99EDD8 \n"
"    LDRH    R3, [R1, #0x8E] \n"
"    CMP     R3, #0 \n"
"    BNE     loc_FF99EDD8 \n"
"    LDRH    R3, [R1, #0x8A] \n"
"    CMP     R3, #2 \n"
"    BNE     loc_FF99EDD8 \n"
"    BL      sub_FF99FFF4 \n"

"loc_FF99EDD8:\n"
"    LDR     R1, =0xA4840 \n"
"    MOV     R3, #0x8200 \n"
"    LDRH    R2, [R1] \n"
"    ADD     R3, R3, #0xA \n"
"    CMP     R2, R3 \n"
"    BEQ     loc_FF99EE20 \n"
"    LDRH    R3, [R1, #0x90] \n"
"    CMP     R3, #3 \n"
"    BEQ     loc_FF99EE20 \n"
"    LDR     R3, [R4, #0xC] \n"
"    CMP     R3, #1 \n"
"    BLS     loc_FF99EE20 \n"
"    LDRH    R3, [R1, #0x8E] \n"
"    CMP     R3, #0 \n"
"    BNE     loc_FF99EE20 \n"
"    LDRH    R3, [R1, #0x8A] \n"
"    CMP     R3, #2 \n"
"    BEQ     loc_FF99EE88 \n"

"loc_FF99EE20:\n"
"    LDR     R2, =0xA4840 \n"
"    LDRH    R3, [R2, #0x90] \n"
"    CMP     R3, #3 \n"
"    BEQ     loc_FF99EEA0 \n"
"    LDRH    R3, [R2, #0x8E] \n"
"    CMP     R3, #0 \n"
"    BNE     loc_FF99EEA0 \n"
"    LDRH    R1, [R2, #0x8A] \n"
"    CMP     R1, #1 \n"
"    BNE     loc_FF99EEA0 \n"
"    LDRH    R2, [R2] \n"
"    MOV     R3, #0x8200 \n"
"    ADD     R3, R3, #0xA \n"
"    CMP     R2, R3 \n"
"    BEQ     loc_FF99EEA0 \n"
"    LDR     R3, [R4, #0xC] \n"
"    CMP     R3, #1 \n"
"    BLS     loc_FF99EEA0 \n"
"    ADD     R3, R1, #0xFF00 \n"
"    ADD     R3, R3, #0xFF \n"
"    MOV     R3, R3, LSL#16 \n"
"    CMP     R3, #0x10000 \n"
"    BHI     loc_FF99EEA0 \n"
"    LDR     R3, [R4, #0x10] \n"
"    CMP     R3, #1 \n"
"    BNE     loc_FF99EEA0 \n"

"loc_FF99EE88:\n"
"    LDR     R3, =0x77BB4 \n"
"    MOV     R2, #0xEA00 \n"
"    LDR     R0, [R3] \n"
"    MOV     R1, #0x8000000 \n"
"    ADD     R2, R2, #0x60 \n"
"    BL      sub_FF9AA57C \n"

"loc_FF99EEA0:\n"
"    LDR     R5, =0xA4840 \n"
"    BL      sub_FF99EC18 \n"
"    LDR     R3, [R5, #0x28] \n"
"    CMP     R3, #0 \n"
"    BNE     loc_FF99EEBC \n"
"    MOV     R0, #2 \n"
"    BL      sub_FFB41B1C \n"

"loc_FF99EEBC:\n"
"    BL      sub_FF99FAC0 \n"
"    LDR     R3, [R5, #0x28] \n"
"    CMP     R3, #0 \n"
"    BNE     loc_FF99EF08 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A2578 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A0E20 \n"
"    TST     R0, #1 \n"
"    BNE     loc_FF99ED7C \n"
"    BL      sub_FF9E6FCC \n"
"    BL      sub_FF825AD0 \n"
"    STR     R0, [R4, #0x14] \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A2A28 \n"
"    BL      sub_FF9A3424 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A2B40_my \n"  // --> Patched. Old value = 0xFF9A2B40.
"    BL      capt_seq_hook_raw_here\n"   // +
"    B       loc_FF99EF1C \n"

"loc_FF99EF08:\n"
"    LDR     R3, =0x6E20 \n"
"    LDR     R2, [R3] \n"
"    CMP     R2, #0 \n"
"    MOVNE   R0, #0x1D \n"
"    MOVEQ   R0, #0 \n"

"loc_FF99EF1C:\n"
"    MOV     R1, #1 \n"
"    MOV     R2, R4 \n"
"    BL      sub_FF99D200 \n"
"    BL      sub_FF9A2F14 \n"
"    CMP     R0, #0 \n"
"    LDRNE   R3, [R4, #8] \n"
"    ORRNE   R3, R3, #0x2000 \n"
"    STRNE   R3, [R4, #8] \n"
"    LDR     R2, =0xA4840 \n"
"    LDRH    R3, [R2, #0x90] \n"
"    CMP     R3, #3 \n"
"    LDMEQFD SP!, {R4,R5,PC} \n"
"    LDRH    R3, [R2, #0x8E] \n"
"    CMP     R3, #0 \n"
"    LDMNEFD SP!, {R4,R5,PC} \n"
"    LDRH    R3, [R2, #0x8A] \n"
"    CMP     R3, #2 \n"
"    LDMNEFD SP!, {R4,R5,PC} \n"
"    MOV     R0, R4 \n"
"    LDMFD   SP!, {R4,R5,LR} \n"
"    B       sub_FF9A004C \n"
);
}

/*************************************************************/
//** sub_FF9A2B40_my @ 0xFF9A2B40 - 0xFF9A2B98, length=23
void __attribute__((naked,noinline)) sub_FF9A2B40_my() {
asm volatile (
"    STMFD   SP!, {R4,LR} \n"
"    MOV     R4, R0 \n"
"    SUB     SP, SP, #0xC \n"
"    BL      sub_FF9A35AC \n"
"    MVN     R1, #0 \n"
"    BL      sub_FF820E7C /*_ClearEventFlag*/ \n"
"    MOV     R0, #0x120 \n"
"    ADD     R0, R0, #2 \n"
"    ADD     R1, SP, #4 \n"
"    MOV     R2, #4 \n"
"    BL      _GetPropertyCase \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF9A2B80 \n"
"    LDR     R0, =0xFF9A29BC /*'CaptureSeq.c'*/ \n"
"    MOV     R1, #0x1DC \n"
"    BL      _DebugAssert \n"

"loc_FF9A2B80:\n"
"    LDR     R3, =0xA4840 \n"
"    LDR     R2, =0xA4900 \n"
"    LDR     R0, [R3, #0x84] \n"
"    LDRSH   R1, [R2, #0xE] \n"
"    BL      sub_FF8B226C \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A2940 \n"
"    BL      wait_until_remote_button_is_released\n"
"    BL      capt_seq_hook_set_nr\n"
"    LDR     PC, =0xFF9A2B9C \n"  // Continue in firmware
);
}

/*************************************************************/
//** exp_drv_task @ 0xFF92B234 - 0xFF92B734, length=321
void __attribute__((naked,noinline)) exp_drv_task() {
asm volatile (
"    STMFD   SP!, {R4-R8,LR} \n"
"    SUB     SP, SP, #0x20 \n"
"    ADD     R7, SP, #4 \n"
"    B       loc_FF92B6F0 \n"

"loc_FF92B244:\n"
"    CMP     R2, #0x22 \n"
"    BNE     loc_FF92B25C \n"
"    LDR     R0, [R12, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R12, #0x88] \n"
"    B       loc_FF92B2C0 \n"

"loc_FF92B25C:\n"
"    CMP     R2, #0x1D \n"
"    BNE     loc_FF92B270 \n"
"    MOV     R0, R12 \n"
"    BL      sub_FF92B104 \n"
"    B       loc_FF92B2B0 \n"

"loc_FF92B270:\n"
"    CMP     R2, #0x1E \n"
"    BNE     loc_FF92B284 \n"
"    MOV     R0, R12 \n"
"    BL      sub_FF92B160 \n"
"    B       loc_FF92B2B0 \n"

"loc_FF92B284:\n"
"    SUB     R3, R2, #0x1F \n"
"    CMP     R3, #1 \n"
"    BHI     loc_FF92B29C \n"
"    MOV     R0, R12 \n"
"    BL      sub_FF92B1BC \n"
"    B       loc_FF92B2B0 \n"

"loc_FF92B29C:\n"
"    CMP     R2, #0x21 \n"
"    BNE     loc_FF92B2CC \n"
"    BL      sub_FF8C7CA4 \n"
"    BL      sub_FF8CAD98 \n"
"    BL      sub_FF8C9FD0 \n"

"loc_FF92B2B0:\n"
"    LDR     R3, [SP, #4] \n"
"    LDR     R0, [R3, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R3, #0x88] \n"

"loc_FF92B2C0:\n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF926CB0 \n"
"    B       loc_FF92B6F0 \n"

"loc_FF92B2CC:\n"
"    CMP     R2, #0xD \n"
"    MOV     R8, #1 \n"
"    BNE     loc_FF92B33C \n"
"    LDR     R1, [R12, #0x7C] \n"
"    ADD     R1, R1, R1, LSL#1 \n"
"    ADD     R1, R12, R1, LSL#2 \n"
"    ADD     R6, SP, #0x14 \n"
"    SUB     R1, R1, #8 \n"
"    MOV     R2, #0xC \n"
"    MOV     R0, R6 \n"
"    BL      _memcpy \n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF92978C \n"
"    LDR     R3, [SP, #4] \n"
"    LDR     R1, [R3, #0x7C] \n"
"    LDR     R2, [R3, #0x8C] \n"
"    ADD     R0, R3, #4 \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R3, #0x88] \n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF929A5C \n"
"    LDR     R3, [SP, #4] \n"
"    ADD     R0, R3, #4 \n"
"    LDR     R1, [R3, #0x7C] \n"
"    LDR     R2, [R3, #0x94] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R3, #0x90] \n"
"    B       loc_FF92B68C \n"

"loc_FF92B33C:\n"
"    SUB     R3, R2, #0xE \n"
"    CMP     R3, #1 \n"
"    BHI     loc_FF92B3F8 \n"
"    ADD     R6, SP, #0x14 \n"
"    ADD     R5, SP, #8 \n"
"    MOV     R0, R12 \n"
"    MOV     R1, R6 \n"
"    MOV     R2, R5 \n"
"    BL      sub_FF929B50 \n"
"    MOV     R4, R0 \n"
"    CMP     R4, #5 \n"
"    CMPNE   R4, #1 \n"
"    BNE     loc_FF92B390 \n"
"    LDR     R12, [SP, #4] \n"
"    MOV     R0, R5 \n"
"    LDR     R1, [R12, #0x7C] \n"
"    MOV     R2, R4 \n"
"    LDR     R3, [R12, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R12, #0x88] \n"
"    B       loc_FF92B3C8 \n"

"loc_FF92B390:\n"
"    CMP     R4, #6 \n"
"    CMPNE   R4, #2 \n"
"    BNE     loc_FF92B3D8 \n"
"    LDR     R12, [SP, #4] \n"
"    MOV     R0, R5 \n"
"    MOV     R1, R8 \n"
"    MOV     R2, R4 \n"
"    LDR     R3, [R12, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R12, #0x88] \n"
"    MOV     R1, R6 \n"
"    LDR     R0, [SP, #4] \n"
"    MOV     R2, R5 \n"
"    BL      sub_FF92AD70 \n"

"loc_FF92B3C8:\n"
"    MOV     R1, R4 \n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF92B098 \n"
"    B       loc_FF92B68C \n"

"loc_FF92B3D8:\n"
"    LDR     R12, [SP, #4] \n"
"    MOV     R2, R4 \n"
"    ADD     R0, R12, #4 \n"
"    LDR     R1, [R12, #0x7C] \n"
"    LDR     R3, [R12, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R12, #0x88] \n"
"    B       loc_FF92B68C \n"

"loc_FF92B3F8:\n"
"    SUB     R3, R2, #0x19 \n"
"    CMP     R3, #1 \n"
"    BHI     loc_FF92B450 \n"
"    LDR     R1, [R12, #0x7C] \n"
"    ADD     R1, R1, R1, LSL#1 \n"
"    ADD     R1, R12, R1, LSL#2 \n"
"    ADD     R6, SP, #0x14 \n"
"    SUB     R1, R1, #8 \n"
"    MOV     R2, #0xC \n"
"    MOV     R0, R6 \n"
"    BL      _memcpy \n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF928B84 \n"
"    LDR     R3, [SP, #4] \n"
"    ADD     R0, R3, #4 \n"
"    LDR     R1, [R3, #0x7C] \n"
"    LDR     R2, [R3, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R3, #0x88] \n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF928F60 \n"
"    B       loc_FF92B68C \n"

"loc_FF92B450:\n"
"    ADD     R6, SP, #0x14 \n"
"    ADD     R1, R12, #4 \n"
"    MOV     R2, #0xC \n"
"    MOV     R0, R6 \n"
"    BL      _memcpy \n"
"    LDR     R12, [SP, #4] \n"
"    LDR     R3, [R12] \n"
"    MOV     R2, R12 \n"
"    CMP     R3, #0x1C \n"
"    LDRLS   PC, [PC, R3, LSL#2] \n"
"    B       loc_FF92B678 \n"
"    .long   loc_FF92B4F0 \n"
"    .long   loc_FF92B4FC \n"
"    .long   loc_FF92B508 \n"
"    .long   loc_FF92B508 \n"
"    .long   loc_FF92B4F0 \n"
"    .long   loc_FF92B4FC \n"
"    .long   loc_FF92B508 \n"
"    .long   loc_FF92B508 \n"
"    .long   loc_FF92B52C \n"
"    .long   loc_FF92B52C \n"
"    .long   loc_FF92B64C \n"
"    .long   loc_FF92B658 \n"
"    .long   loc_FF92B668 \n"
"    .long   loc_FF92B678 \n"
"    .long   loc_FF92B678 \n"
"    .long   loc_FF92B678 \n"
"    .long   loc_FF92B514 \n"
"    .long   loc_FF92B520 \n"
"    .long   loc_FF92B53C \n"
"    .long   loc_FF92B548 \n"
"    .long   loc_FF92B580 \n"
"    .long   loc_FF92B5B8 \n"
"    .long   loc_FF92B5F0 \n"
"    .long   loc_FF92B628 \n"
"    .long   loc_FF92B628 \n"
"    .long   loc_FF92B678 \n"
"    .long   loc_FF92B678 \n"
"    .long   loc_FF92B634 \n"
"    .long   loc_FF92B640 \n"

"loc_FF92B4F0:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF927560 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B4FC:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF927804 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B508:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF927A78 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B514:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF927D74 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B520:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF927FD8 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B52C:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF9281D4_my \n"  // --> Patched. Old value = 0xFF9281D4.
"    MOV     R8, #0 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B53C:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF928330 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B548:\n"
"    LDRH    R1, [R2, #4] \n"
"    LDR     R3, =0x51BC8 \n"
"    STRH    R1, [SP, #0x14] \n"
"    LDRH    R1, [R3, #6] \n"
"    STRH    R1, [SP, #0x1A] \n"
"    LDRH    R1, [R3, #2] \n"
"    STRH    R1, [SP, #0x16] \n"
"    LDRH    R3, [R3, #4] \n"
"    STRH    R3, [SP, #0x18] \n"
"    MOV     R0, R2 \n"
"    LDRH    R2, [R2, #0xC] \n"
"    STRH    R2, [SP, #0x1C] \n"
"    BL      sub_FF92862C \n"
"    B       loc_FF92B674 \n"

"loc_FF92B580:\n"
"    MOV     R0, R2 \n"
"    LDRH    R2, [R2, #4] \n"
"    LDR     R3, =0x51BC8 \n"
"    STRH    R2, [SP, #0x14] \n"
"    LDRH    R2, [R3, #8] \n"
"    STRH    R2, [SP, #0x1C] \n"
"    LDRH    R1, [R3, #2] \n"
"    STRH    R1, [SP, #0x16] \n"
"    LDRH    R2, [R3, #4] \n"
"    STRH    R2, [SP, #0x18] \n"
"    LDRH    R3, [R3, #6] \n"
"    STRH    R3, [SP, #0x1A] \n"
"    BL      sub_FF928754 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B5B8:\n"
"    LDR     R3, =0x51BC8 \n"
"    LDRH    R1, [R3] \n"
"    STRH    R1, [SP, #0x14] \n"
"    MOV     R0, R2 \n"
"    LDRH    R2, [R2, #6] \n"
"    STRH    R2, [SP, #0x16] \n"
"    LDRH    R2, [R3, #8] \n"
"    STRH    R2, [SP, #0x1C] \n"
"    LDRH    R1, [R3, #4] \n"
"    STRH    R1, [SP, #0x18] \n"
"    LDRH    R3, [R3, #6] \n"
"    STRH    R3, [SP, #0x1A] \n"
"    BL      sub_FF928818 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B5F0:\n"
"    LDR     R3, =0x51BC8 \n"
"    LDRH    R1, [R3, #6] \n"
"    STRH    R1, [SP, #0x1A] \n"
"    LDRH    R1, [R3] \n"
"    STRH    R1, [SP, #0x14] \n"
"    LDRH    R1, [R3, #2] \n"
"    STRH    R1, [SP, #0x16] \n"
"    LDRH    R3, [R3, #4] \n"
"    STRH    R3, [SP, #0x18] \n"
"    MOV     R0, R2 \n"
"    LDRH    R2, [R2, #0xC] \n"
"    STRH    R2, [SP, #0x1C] \n"
"    BL      sub_FF9288D0 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B628:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF928980 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B634:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF9290B0 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B640:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF9292AC \n"
"    B       loc_FF92B674 \n"

"loc_FF92B64C:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF929468 \n"
"    B       loc_FF92B674 \n"

"loc_FF92B658:\n"
"    MOV     R0, R2 \n"
"    MOV     R1, #0 \n"
"    BL      sub_FF92964C \n"
"    B       loc_FF92B674 \n"

"loc_FF92B668:\n"
"    MOV     R0, R2 \n"
"    MOV     R1, #1 \n"
"    BL      sub_FF92964C \n"

"loc_FF92B674:\n"
"    LDR     R12, [SP, #4] \n"

"loc_FF92B678:\n"
"    ADD     R0, R12, #4 \n"
"    LDR     R1, [R12, #0x7C] \n"
"    LDR     R2, [R12, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R12, #0x88] \n"

"loc_FF92B68C:\n"
"    CMP     R8, #1 \n"
"    BNE     loc_FF92B6B4 \n"
"    LDR     R1, [SP, #4] \n"
"    LDR     R3, [R1, #0x7C] \n"
"    ADD     R3, R3, R3, LSL#1 \n"
"    ADD     R1, R1, R3, LSL#2 \n"
"    MOV     R0, R6 \n"
"    SUB     R1, R1, #8 \n"
"    BL      sub_FF9272C4 \n"
"    B       loc_FF92B6E8 \n"

"loc_FF92B6B4:\n"
"    MOV     R4, #1 \n"
"    MOV     R0, R4 \n"
"    MOV     R1, R4 \n"
"    MOV     R2, R4 \n"
"    MOV     R3, R4 \n"
"    STR     R4, [SP] \n"
"    BL      sub_FF927218 \n"
"    MOV     R0, R4 \n"
"    MOV     R1, R0 \n"
"    MOV     R2, R0 \n"
"    MOV     R3, R0 \n"
"    STR     R4, [SP] \n"
"    BL      sub_FF92739C \n"

"loc_FF92B6E8:\n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF926CB0 \n"

"loc_FF92B6F0:\n"
"    LDR     R3, =0x51BC0 \n"
"    MOV     R2, #0 \n"
"    LDR     R0, [R3] \n"
"    MOV     R1, R7 \n"
"    BL      sub_FF8213F8 /*_ReceiveMessageQueue*/ \n"
"    LDR     R12, [SP, #4] \n"
"    LDR     R2, [R12] \n"
"    CMP     R2, #0x23 \n"
"    BNE     loc_FF92B244 \n"
"    MOV     R0, R12 \n"
"    BL      sub_FF926CB0 \n"
"    LDR     R3, =0x51BBC \n"
"    MOV     R1, #1 \n"
"    LDR     R0, [R3] \n"
"    BL      sub_FF820CE0 /*_SetEventFlag*/ \n"
"    BL      _ExitTask \n"
"    ADD     SP, SP, #0x20 \n"
"    LDMFD   SP!, {R4-R8,PC} \n"
);
}

/*************************************************************/
//** sub_FF9281D4_my @ 0xFF9281D4 - 0xFF928318, length=82
void __attribute__((naked,noinline)) sub_FF9281D4_my() {
asm volatile (
"    STMFD   SP!, {R4-R6,LR} \n"
"    LDR     R3, =0x51BBC \n"
"    MOV     R4, R0 \n"
"    MOV     R1, #0x3E \n"
"    LDR     R0, [R3] \n"
"    BL      sub_FF820E7C /*_ClearEventFlag*/ \n"
"    MOV     R1, #0 \n"
"    LDRSH   R0, [R4, #4] \n"
"    BL      sub_FF926DE4 \n"
"    MOV     R6, R0 \n"
"    LDRSH   R0, [R4, #6] \n"
"    BL      sub_FF926F58 \n"
"    LDRSH   R0, [R4, #8] \n"
"    BL      sub_FF926FF4 \n"
"    LDRSH   R0, [R4, #0xA] \n"
"    BL      sub_FF927090 \n"
"    LDRSH   R0, [R4, #0xC] \n"
"    BL      sub_FF92712C \n"
"    LDR     R3, [R4] \n"
"    CMP     R3, #9 \n"
"    MOV     R5, R0 \n"
"    MOVEQ   R5, #0 \n"
"    MOVEQ   R6, R5 \n"
"    CMP     R6, #1 \n"
"    BNE     loc_FF928258 \n"
"    MOV     R2, #2 \n"
"    LDRSH   R0, [R4, #4] \n"
"    LDR     R1, =0xFF926D04 \n"
"    BL      sub_FFB33A1C \n"
"    LDR     R2, =0x51BFC \n"
"    MOV     R3, #0 \n"
"    STR     R3, [R2] \n"
"    B       loc_FF92825C \n"

"loc_FF928258:\n"
"    BL      sub_FF9271C8 \n"

"loc_FF92825C:\n"
"    STRH    R0, [R4, #4] \n"
"    CMP     R5, #1 \n"
"    BNE     loc_FF92827C \n"
"    LDRSH   R0, [R4, #0xC] \n"
"    LDR     R1, =0xFF926DC8 \n"
"    MOV     R2, #0x20 \n"
"    BL      sub_FF927500 \n"
"    B       loc_FF928280 \n"

"loc_FF92827C:\n"
"    BL      sub_FF927208 \n"

"loc_FF928280:\n"
"    STRH    R0, [R4, #0xC] \n"
"    LDRSH   R0, [R4, #6] \n"
"    BL      sub_FF8C792C_my \n"  // --> Patched. Old value = 0xFF8C792C.
"    LDRSH   R0, [R4, #8] \n"
"    MOV     R1, #1 \n"
"    BL      sub_FF8C9B90 \n"
"    ADD     R0, R4, #8 \n"
"    MOV     R1, #0 \n"
"    BL      sub_FF8C9C50 \n"
"    LDRSH   R0, [R4, #0xE] \n"
"    BL      sub_FF9148E0 \n"
"    CMP     R6, #1 \n"
"    BNE     loc_FF9282E4 \n"
"    LDR     R3, =0x51BBC \n"
"    MOV     R2, #0xBB0 \n"
"    LDR     R0, [R3] \n"
"    MOV     R1, #2 \n"
"    ADD     R2, R2, #8 \n"
"    BL      sub_FF820CD0 /*_WaitForAllEventFlag*/ \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF9282E4 \n"
"    MOV     R1, #0x440 \n"
"    LDR     R0, =0xFF926C5C /*'ExpDrv.c'*/ \n"
"    ADD     R1, R1, #0xB \n"
"    BL      _DebugAssert \n"

"loc_FF9282E4:\n"
"    CMP     R5, #1 \n"
"    LDMNEFD SP!, {R4-R6,PC} \n"
"    LDR     R3, =0x51BBC \n"
"    MOV     R2, #0xBB0 \n"
"    LDR     R0, [R3] \n"
"    MOV     R1, #0x20 \n"
"    ADD     R2, R2, #8 \n"
"    BL      sub_FF820CD0 /*_WaitForAllEventFlag*/ \n"
"    TST     R0, #1 \n"
"    LDMEQFD SP!, {R4-R6,PC} \n"
"    LDR     R0, =0xFF926C5C /*'ExpDrv.c'*/ \n"
"    MOV     R1, #0x450 \n"
"    LDMFD   SP!, {R4-R6,LR} \n"
"    B       _DebugAssert \n"
);
}

/*************************************************************/
//** sub_FF8C792C_my @ 0xFF8C792C - 0xFF8C7988, length=24
void __attribute__((naked,noinline)) sub_FF8C792C_my() {
asm volatile (
"    STMFD   SP!, {R4,LR} \n"
"    LDR     R3, =0x584C \n"
"    LDR     R2, [R3] \n"
"    MOV     R1, #0x150 \n"
"    MOV     R3, R0, LSL#16 \n"
"    CMP     R2, #1 \n"
"    ADD     R1, R1, #1 \n"
"    LDR     R0, =0xFF8C7168 /*'Shutter.c'*/ \n"
"    MOV     R4, R3, ASR#16 \n"
"    BEQ     loc_FF8C7958 \n"
"    BL      _DebugAssert \n"

"loc_FF8C7958:\n"
"    MOV     R1, #0x154 \n"
"    CMN     R4, #0xC00 \n"
"    LDR     R3, =0x363CE \n"
"    LDR     R0, =0xFF8C7168 /*'Shutter.c'*/ \n"
"    ADD     R1, R1, #3 \n"
"    LDREQSH R4, [R3] \n"
"    LDRNE   R3, =0x363CE \n"
"    CMN     R4, #0xC00 \n"
"    STRH    R4, [R3] \n"
"    BNE     loc_FF8C7984 \n"
"    BL      _DebugAssert \n"

"loc_FF8C7984:\n"
"    MOV     R0, R4 \n"
"    BL      apex2us \n"  // --> Patched. Old value = _apex2us.
"    LDR     PC, =0xFF8C798C \n"  // Continue in firmware
);
}
