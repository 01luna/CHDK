/*
 * capt_seq.c - auto-generated by CHDK code_gen.
 */
#include "lolevel.h"
#include "platform.h"
#include "core.h"

static long *nrflag = (long*)0x6E50;

#include "../../../generic/capt_seq.c"

/*************************************************************/
//** capt_seq_task @ 0xFF99F334 - 0xFF99F560, length=140
void __attribute__((naked,noinline)) capt_seq_task() {
asm volatile (
"    STMFD   SP!, {R4,R5,LR} \n"
"    SUB     SP, SP, #4 \n"
"    MOV     R5, SP \n"
"    B       loc_FF99F52C \n"

"loc_FF99F344:\n"
"    LDR     R2, [SP] \n"
"    LDR     R3, [R2] \n"
"    MOV     R0, R2 \n"
"    CMP     R3, #0x19 \n"
"    LDRLS   PC, [PC, R3, LSL#2] \n"
"    B       loc_FF99F500 \n"
"    .long   loc_FF99F3C4 \n"
"    .long   loc_FF99F3E4 \n"
"    .long   loc_FF99F3F8 \n"
"    .long   loc_FF99F40C \n"
"    .long   loc_FF99F404 \n"
"    .long   loc_FF99F414 \n"
"    .long   loc_FF99F41C \n"
"    .long   loc_FF99F428 \n"
"    .long   loc_FF99F430 \n"
"    .long   loc_FF99F43C \n"
"    .long   loc_FF99F444 \n"
"    .long   loc_FF99F44C \n"
"    .long   loc_FF99F454 \n"
"    .long   loc_FF99F45C \n"
"    .long   loc_FF99F464 \n"
"    .long   loc_FF99F470 \n"
"    .long   loc_FF99F478 \n"
"    .long   loc_FF99F480 \n"
"    .long   loc_FF99F488 \n"
"    .long   loc_FF99F494 \n"
"    .long   loc_FF99F4A0 \n"
"    .long   loc_FF99F4A8 \n"
"    .long   loc_FF99F4E8 \n"
"    .long   loc_FF99F4F0 \n"
"    .long   loc_FF99F4F8 \n"
"    .long   loc_FF99F514 \n"

"loc_FF99F3C4:\n"
"    BL      sub_FF99FA68 \n"

// only do quick press hack if overrides are active
"    BL      captseq_hack_override_active\n" // returns 1 if tv or sv override in effect
"    STR     R2, [SP,#-4]!\n" // push return value
"    BL      shooting_expo_param_override\n"   // +

"    BL      sub_FF99CBE4 \n"
"    LDR     R3, =0xA4840 \n"

"    LDR     R2, [SP], #4\n" // pop override hack
"    CMP     R2, #1\n"     // +
"    MOVEQ   R2, #0\n"     // +
"    STREQ   R2, [R3, #0x28]\n"  // fixes overrides behavior at short shutter press
"    LDRNE   R2, [R3, #0x28]\n" // modified NE
"    CMPNE   R2, #0\n"         // modified NE

//"  LDR     R2, [R3, #0x28] \n"  // above patch makes these lines redundant
//"  CMP     R2, #0 \n"
"    BEQ     loc_FF99F510 \n"
"    BL      sub_FF99EF00_my \n"  // --> Patched. Old value = 0xFF99EF00.
"    B       loc_FF99F510 \n"

"loc_FF99F3E4:\n"
"    BL      sub_FF99ECBC_my \n"  // --> Patched. Old value = 0xFF99ECBC.

"loc_FF99F3E8:\n"
"    LDR     R2, =0xA4840 \n"
"    MOV     R3, #0 \n"
"    STR     R3, [R2, #0x28] \n"
"    B       loc_FF99F510 \n"

"loc_FF99F3F8:\n"
"    MOV     R0, #1 \n"
"    BL      sub_FF99FD28 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F404:\n"
"    BL      sub_FF99F628 \n"
"    B       loc_FF99F3E8 \n"

"loc_FF99F40C:\n"
"    BL      sub_FF99FA20 \n"
"    B       loc_FF99F3E8 \n"

"loc_FF99F414:\n"
"    BL      sub_FF99FA30 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F41C:\n"
"    BL      sub_FF99FBC8 \n"
"    BL      sub_FF99CBE4 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F428:\n"
"    BL      sub_FF99EFE4 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F430:\n"
"    BL      sub_FF99FC7C \n"
"    BL      sub_FF99CBE4 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F43C:\n"
"    BL      sub_FF99FA20 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F444:\n"
"    BL      sub_FF9A1674 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F44C:\n"
"    BL      sub_FF9A18B8 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F454:\n"
"    BL      sub_FF9A1970 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F45C:\n"
"    BL      sub_FF9A1A0C \n"
"    B       loc_FF99F510 \n"

"loc_FF99F464:\n"
"    MOV     R0, #0 \n"
"    BL      sub_FF9A1E94 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F470:\n"
"    BL      sub_FF9A20A0 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F478:\n"
"    BL      sub_FF9A2138 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F480:\n"
"    BL      sub_FF9A21F4 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F488:\n"
"    MOV     R0, #1 \n"
"    BL      sub_FF9A1E94 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F494:\n"
"    BL      sub_FF99FEFC \n"
"    BL      sub_FF99EA7C \n"
"    B       loc_FF99F510 \n"

"loc_FF99F4A0:\n"
"    BL      sub_FF9A1D1C \n"
"    B       loc_FF99F510 \n"

"loc_FF99F4A8:\n"
"    LDR     R4, =0xA48A0 \n"
"    MOV     R0, #0x11 \n"
"    MOV     R1, R4 \n"
"    MOV     R2, #2 \n"
"    BL      _GetPropertyCase \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF99F4D4 \n"
"    MOV     R1, #0x4C0 \n"
"    LDR     R0, =0xFF99E7BC /*'ShootTask.c'*/ \n"
"    ADD     R1, R1, #6 \n"
"    BL      _DebugAssert \n"

"loc_FF99F4D4:\n"
"    LDRH    R3, [R4] \n"
"    CMP     R3, #1 \n"
"    BNE     loc_FF99F510 \n"
"    BL      sub_FF9A1D08 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F4E8:\n"
"    BL      sub_FF9A1DB4 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F4F0:\n"
"    BL      sub_FF99EB9C \n"
"    B       loc_FF99F510 \n"

"loc_FF99F4F8:\n"
"    BL      sub_FF99B988 \n"
"    B       loc_FF99F510 \n"

"loc_FF99F500:\n"
"    MOV     R1, #0x4E0 \n"
"    LDR     R0, =0xFF99E7BC /*'ShootTask.c'*/ \n"
"    ADD     R1, R1, #7 \n"
"    BL      _DebugAssert \n"

"loc_FF99F510:\n"
"    LDR     R2, [SP] \n"

"loc_FF99F514:\n"
"    LDR     R3, =0x77BB4 \n"
"    LDR     R1, [R2, #4] \n"
"    LDR     R0, [R3] \n"
"    BL      sub_FF820CE0 /*_SetEventFlag*/ \n"
"    LDR     R0, [SP] \n"
"    BL      sub_FF99E8AC \n"

"loc_FF99F52C:\n"
"    LDR     R3, =0x77BB8 \n"
"    MOV     R1, R5 \n"
"    LDR     R0, [R3] \n"
"    MOV     R2, #0 \n"
"    BL      sub_FF8213F8 /*_ReceiveMessageQueue*/ \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF99F344 \n"
"    MOV     R1, #0x410 \n"
"    LDR     R0, =0xFF99E7BC /*'ShootTask.c'*/ \n"
"    ADD     R1, R1, #9 \n"
"    BL      _DebugAssert \n"
"    BL      _ExitTask \n"
"    ADD     SP, SP, #4 \n"
"    LDMFD   SP!, {R4,R5,PC} \n"
);
}

/*************************************************************/
//** sub_FF99EF00_my @ 0xFF99EF00 - 0xFF99EFDC, length=56
void __attribute__((naked,noinline)) sub_FF99EF00_my() {
asm volatile (
"    STMFD   SP!, {R4,LR} \n"
"    BL      sub_FF99E6A8 \n"
"    LDR     R3, =0xA4840 \n"
"    LDR     R2, [R3, #0x28] \n"
"    CMP     R2, #0 \n"
"    MOV     R4, R0 \n"
"    MOV     R0, #0xC \n"
"    BEQ     loc_FF99EF48 \n"
"    BL      sub_FF9AA050 \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF99EF48 \n"
"    LDR     R3, [R4, #8] \n"
"    LDR     R2, =0x6E20 \n"
"    ORR     R3, R3, #0x40000000 \n"
"    MOV     R1, #1 \n"
"    STR     R1, [R2] \n"
"    STR     R3, [R4, #8] \n"
"    LDMFD   SP!, {R4,PC} \n"

"loc_FF99EF48:\n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A24F4 \n"
"    BL      sub_FF9E6F24 \n"
"    BL      sub_FF825AD0 \n"
"    STR     R0, [R4, #0x14] \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A2ABC_my \n"  // --> Patched. Old value = 0xFF9A2ABC.
"    BL      capt_seq_hook_raw_here\n"   // +
"    TST     R0, #1 \n"
"    LDRNE   R3, =0x6E20 \n"
"    MOVNE   R2, #1 \n"
"    STRNE   R2, [R3] \n"
"    LDMFD   SP!, {R4,PC} \n"
);
}

/*************************************************************/
//** sub_FF99ECBC_my @ 0xFF99ECBC - 0xFF99EEF0, length=142
void __attribute__((naked,noinline)) sub_FF99ECBC_my() {
asm volatile (
"    STMFD   SP!, {R4,R5,LR} \n"
"    LDR     R3, =0xA4840 \n"
"    LDR     R4, [R0, #0xC] \n"
"    LDR     R1, [R3, #0x28] \n"
"    LDR     R2, [R4, #8] \n"
"    CMP     R1, #0 \n"
"    ORR     R2, R2, #1 \n"
"    STR     R2, [R4, #8] \n"
"    BNE     loc_FF99ED10 \n"
"    MOV     R0, #0xC \n"
"    BL      sub_FF9AA050 \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF99ED10 \n"
"    LDR     R3, [R4, #8] \n"
"    MOV     R0, #1 \n"
"    ORR     R3, R3, #0x40000000 \n"
"    STR     R3, [R4, #8] \n"

"loc_FF99ED00:\n"
"    MOV     R2, R4 \n"
"    MOV     R1, #1 \n"
"    LDMFD   SP!, {R4,R5,LR} \n"
"    B       sub_FF99D184 \n"

"loc_FF99ED10:\n"
"    LDR     R1, =0xA4840 \n"
"    MOV     R3, #0x8200 \n"
"    LDRH    R2, [R1] \n"
"    ADD     R3, R3, #0xA \n"
"    CMP     R2, R3 \n"
"    BEQ     loc_FF99ED5C \n"
"    LDRH    R3, [R1, #0x90] \n"
"    CMP     R3, #3 \n"
"    BEQ     loc_FF99ED5C \n"
"    LDR     R3, [R4, #0xC] \n"
"    CMP     R3, #1 \n"
"    BLS     loc_FF99ED5C \n"
"    LDRH    R3, [R1, #0x8E] \n"
"    CMP     R3, #0 \n"
"    BNE     loc_FF99ED5C \n"
"    LDRH    R3, [R1, #0x8A] \n"
"    CMP     R3, #2 \n"
"    BNE     loc_FF99ED5C \n"
"    BL      sub_FF99FF74 \n"

"loc_FF99ED5C:\n"
"    LDR     R1, =0xA4840 \n"
"    MOV     R3, #0x8200 \n"
"    LDRH    R2, [R1] \n"
"    ADD     R3, R3, #0xA \n"
"    CMP     R2, R3 \n"
"    BEQ     loc_FF99EDA4 \n"
"    LDRH    R3, [R1, #0x90] \n"
"    CMP     R3, #3 \n"
"    BEQ     loc_FF99EDA4 \n"
"    LDR     R3, [R4, #0xC] \n"
"    CMP     R3, #1 \n"
"    BLS     loc_FF99EDA4 \n"
"    LDRH    R3, [R1, #0x8E] \n"
"    CMP     R3, #0 \n"
"    BNE     loc_FF99EDA4 \n"
"    LDRH    R3, [R1, #0x8A] \n"
"    CMP     R3, #2 \n"
"    BEQ     loc_FF99EE0C \n"

"loc_FF99EDA4:\n"
"    LDR     R2, =0xA4840 \n"
"    LDRH    R3, [R2, #0x90] \n"
"    CMP     R3, #3 \n"
"    BEQ     loc_FF99EE24 \n"
"    LDRH    R3, [R2, #0x8E] \n"
"    CMP     R3, #0 \n"
"    BNE     loc_FF99EE24 \n"
"    LDRH    R1, [R2, #0x8A] \n"
"    CMP     R1, #1 \n"
"    BNE     loc_FF99EE24 \n"
"    LDRH    R2, [R2] \n"
"    MOV     R3, #0x8200 \n"
"    ADD     R3, R3, #0xA \n"
"    CMP     R2, R3 \n"
"    BEQ     loc_FF99EE24 \n"
"    LDR     R3, [R4, #0xC] \n"
"    CMP     R3, #1 \n"
"    BLS     loc_FF99EE24 \n"
"    ADD     R3, R1, #0xFF00 \n"
"    ADD     R3, R3, #0xFF \n"
"    MOV     R3, R3, LSL#16 \n"
"    CMP     R3, #0x10000 \n"
"    BHI     loc_FF99EE24 \n"
"    LDR     R3, [R4, #0x10] \n"
"    CMP     R3, #1 \n"
"    BNE     loc_FF99EE24 \n"

"loc_FF99EE0C:\n"
"    LDR     R3, =0x77BB4 \n"
"    MOV     R2, #0xEA00 \n"
"    LDR     R0, [R3] \n"
"    MOV     R1, #0x8000000 \n"
"    ADD     R2, R2, #0x60 \n"
"    BL      sub_FF9AA4D4 \n"

"loc_FF99EE24:\n"
"    LDR     R5, =0xA4840 \n"
"    BL      sub_FF99EB9C \n"
"    LDR     R3, [R5, #0x28] \n"
"    CMP     R3, #0 \n"
"    BNE     loc_FF99EE40 \n"
"    MOV     R0, #2 \n"
"    BL      sub_FFB41A74 \n"

"loc_FF99EE40:\n"
"    BL      sub_FF99FA40 \n"
"    LDR     R3, [R5, #0x28] \n"
"    CMP     R3, #0 \n"
"    BNE     loc_FF99EE8C \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A24F4 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A0DA0 \n"
"    TST     R0, #1 \n"
"    BNE     loc_FF99ED00 \n"
"    BL      sub_FF9E6F24 \n"
"    BL      sub_FF825AD0 \n"
"    STR     R0, [R4, #0x14] \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A29A4 \n"
"    BL      sub_FF9A33A0 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A2ABC_my \n"  // --> Patched. Old value = 0xFF9A2ABC.
"    BL      capt_seq_hook_raw_here\n"   // +
"    B       loc_FF99EEA0 \n"

"loc_FF99EE8C:\n"
"    LDR     R3, =0x6E20 \n"
"    LDR     R2, [R3] \n"
"    CMP     R2, #0 \n"
"    MOVNE   R0, #0x1D \n"
"    MOVEQ   R0, #0 \n"

"loc_FF99EEA0:\n"
"    MOV     R1, #1 \n"
"    MOV     R2, R4 \n"
"    BL      sub_FF99D184 \n"
"    BL      sub_FF9A2E90 \n"
"    CMP     R0, #0 \n"
"    LDRNE   R3, [R4, #8] \n"
"    ORRNE   R3, R3, #0x2000 \n"
"    STRNE   R3, [R4, #8] \n"
"    LDR     R2, =0xA4840 \n"
"    LDRH    R3, [R2, #0x90] \n"
"    CMP     R3, #3 \n"
"    LDMEQFD SP!, {R4,R5,PC} \n"
"    LDRH    R3, [R2, #0x8E] \n"
"    CMP     R3, #0 \n"
"    LDMNEFD SP!, {R4,R5,PC} \n"
"    LDRH    R3, [R2, #0x8A] \n"
"    CMP     R3, #2 \n"
"    LDMNEFD SP!, {R4,R5,PC} \n"
"    MOV     R0, R4 \n"
"    LDMFD   SP!, {R4,R5,LR} \n"
"    B       sub_FF99FFCC \n"
);
}

/*************************************************************/
//** sub_FF9A2ABC_my @ 0xFF9A2ABC - 0xFF9A2B14, length=23
void __attribute__((naked,noinline)) sub_FF9A2ABC_my() {
asm volatile (
"    STMFD   SP!, {R4,LR} \n"
"    MOV     R4, R0 \n"
"    SUB     SP, SP, #0xC \n"
"    BL      sub_FF9A3514 \n"
"    MVN     R1, #0 \n"
"    BL      sub_FF820E7C /*_ClearEventFlag*/ \n"
"    MOV     R0, #0x120 \n"
"    ADD     R0, R0, #2 \n"
"    ADD     R1, SP, #4 \n"
"    MOV     R2, #4 \n"
"    BL      _GetPropertyCase \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF9A2AFC \n"
"    LDR     R0, =0xFF9A2938 /*'CaptureSeq.c'*/ \n"
"    MOV     R1, #0x1DC \n"
"    BL      _DebugAssert \n"

"loc_FF9A2AFC:\n"
"    LDR     R3, =0xA4840 \n"
"    LDR     R2, =0xA4900 \n"
"    LDR     R0, [R3, #0x84] \n"
"    LDRSH   R1, [R2, #0xE] \n"
"    BL      sub_FF8B226C \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9A28BC \n"
"    BL      wait_until_remote_button_is_released\n"
"    BL      capt_seq_hook_set_nr\n"
"    LDR     PC, =0xFF9A2B18 \n"  // Continue in firmware
);
}

/*************************************************************/
//** exp_drv_task @ 0xFF92B210 - 0xFF92B710, length=321
void __attribute__((naked,noinline)) exp_drv_task() {
asm volatile (
"    STMFD   SP!, {R4-R8,LR} \n"
"    SUB     SP, SP, #0x20 \n"
"    ADD     R7, SP, #4 \n"
"    B       loc_FF92B6CC \n"

"loc_FF92B220:\n"
"    CMP     R2, #0x22 \n"
"    BNE     loc_FF92B238 \n"
"    LDR     R0, [R12, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R12, #0x88] \n"
"    B       loc_FF92B29C \n"

"loc_FF92B238:\n"
"    CMP     R2, #0x1D \n"
"    BNE     loc_FF92B24C \n"
"    MOV     R0, R12 \n"
"    BL      sub_FF92B0E0 \n"
"    B       loc_FF92B28C \n"

"loc_FF92B24C:\n"
"    CMP     R2, #0x1E \n"
"    BNE     loc_FF92B260 \n"
"    MOV     R0, R12 \n"
"    BL      sub_FF92B13C \n"
"    B       loc_FF92B28C \n"

"loc_FF92B260:\n"
"    SUB     R3, R2, #0x1F \n"
"    CMP     R3, #1 \n"
"    BHI     loc_FF92B278 \n"
"    MOV     R0, R12 \n"
"    BL      sub_FF92B198 \n"
"    B       loc_FF92B28C \n"

"loc_FF92B278:\n"
"    CMP     R2, #0x21 \n"
"    BNE     loc_FF92B2A8 \n"
"    BL      sub_FF8C7CA4 \n"
"    BL      sub_FF8CAD98 \n"
"    BL      sub_FF8C9FD0 \n"

"loc_FF92B28C:\n"
"    LDR     R3, [SP, #4] \n"
"    LDR     R0, [R3, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R3, #0x88] \n"

"loc_FF92B29C:\n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF926C8C \n"
"    B       loc_FF92B6CC \n"

"loc_FF92B2A8:\n"
"    CMP     R2, #0xD \n"
"    MOV     R8, #1 \n"
"    BNE     loc_FF92B318 \n"
"    LDR     R1, [R12, #0x7C] \n"
"    ADD     R1, R1, R1, LSL#1 \n"
"    ADD     R1, R12, R1, LSL#2 \n"
"    ADD     R6, SP, #0x14 \n"
"    SUB     R1, R1, #8 \n"
"    MOV     R2, #0xC \n"
"    MOV     R0, R6 \n"
"    BL      _memcpy \n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF929768 \n"
"    LDR     R3, [SP, #4] \n"
"    LDR     R1, [R3, #0x7C] \n"
"    LDR     R2, [R3, #0x8C] \n"
"    ADD     R0, R3, #4 \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R3, #0x88] \n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF929A38 \n"
"    LDR     R3, [SP, #4] \n"
"    ADD     R0, R3, #4 \n"
"    LDR     R1, [R3, #0x7C] \n"
"    LDR     R2, [R3, #0x94] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R3, #0x90] \n"
"    B       loc_FF92B668 \n"

"loc_FF92B318:\n"
"    SUB     R3, R2, #0xE \n"
"    CMP     R3, #1 \n"
"    BHI     loc_FF92B3D4 \n"
"    ADD     R6, SP, #0x14 \n"
"    ADD     R5, SP, #8 \n"
"    MOV     R0, R12 \n"
"    MOV     R1, R6 \n"
"    MOV     R2, R5 \n"
"    BL      sub_FF929B2C \n"
"    MOV     R4, R0 \n"
"    CMP     R4, #5 \n"
"    CMPNE   R4, #1 \n"
"    BNE     loc_FF92B36C \n"
"    LDR     R12, [SP, #4] \n"
"    MOV     R0, R5 \n"
"    LDR     R1, [R12, #0x7C] \n"
"    MOV     R2, R4 \n"
"    LDR     R3, [R12, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R12, #0x88] \n"
"    B       loc_FF92B3A4 \n"

"loc_FF92B36C:\n"
"    CMP     R4, #6 \n"
"    CMPNE   R4, #2 \n"
"    BNE     loc_FF92B3B4 \n"
"    LDR     R12, [SP, #4] \n"
"    MOV     R0, R5 \n"
"    MOV     R1, R8 \n"
"    MOV     R2, R4 \n"
"    LDR     R3, [R12, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R12, #0x88] \n"
"    MOV     R1, R6 \n"
"    LDR     R0, [SP, #4] \n"
"    MOV     R2, R5 \n"
"    BL      sub_FF92AD4C \n"

"loc_FF92B3A4:\n"
"    MOV     R1, R4 \n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF92B074 \n"
"    B       loc_FF92B668 \n"

"loc_FF92B3B4:\n"
"    LDR     R12, [SP, #4] \n"
"    MOV     R2, R4 \n"
"    ADD     R0, R12, #4 \n"
"    LDR     R1, [R12, #0x7C] \n"
"    LDR     R3, [R12, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R12, #0x88] \n"
"    B       loc_FF92B668 \n"

"loc_FF92B3D4:\n"
"    SUB     R3, R2, #0x19 \n"
"    CMP     R3, #1 \n"
"    BHI     loc_FF92B42C \n"
"    LDR     R1, [R12, #0x7C] \n"
"    ADD     R1, R1, R1, LSL#1 \n"
"    ADD     R1, R12, R1, LSL#2 \n"
"    ADD     R6, SP, #0x14 \n"
"    SUB     R1, R1, #8 \n"
"    MOV     R2, #0xC \n"
"    MOV     R0, R6 \n"
"    BL      _memcpy \n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF928B60 \n"
"    LDR     R3, [SP, #4] \n"
"    ADD     R0, R3, #4 \n"
"    LDR     R1, [R3, #0x7C] \n"
"    LDR     R2, [R3, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R3, #0x88] \n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF928F3C \n"
"    B       loc_FF92B668 \n"

"loc_FF92B42C:\n"
"    ADD     R6, SP, #0x14 \n"
"    ADD     R1, R12, #4 \n"
"    MOV     R2, #0xC \n"
"    MOV     R0, R6 \n"
"    BL      _memcpy \n"
"    LDR     R12, [SP, #4] \n"
"    LDR     R3, [R12] \n"
"    MOV     R2, R12 \n"
"    CMP     R3, #0x1C \n"
"    LDRLS   PC, [PC, R3, LSL#2] \n"
"    B       loc_FF92B654 \n"
"    .long   loc_FF92B4CC \n"
"    .long   loc_FF92B4D8 \n"
"    .long   loc_FF92B4E4 \n"
"    .long   loc_FF92B4E4 \n"
"    .long   loc_FF92B4CC \n"
"    .long   loc_FF92B4D8 \n"
"    .long   loc_FF92B4E4 \n"
"    .long   loc_FF92B4E4 \n"
"    .long   loc_FF92B508 \n"
"    .long   loc_FF92B508 \n"
"    .long   loc_FF92B628 \n"
"    .long   loc_FF92B634 \n"
"    .long   loc_FF92B644 \n"
"    .long   loc_FF92B654 \n"
"    .long   loc_FF92B654 \n"
"    .long   loc_FF92B654 \n"
"    .long   loc_FF92B4F0 \n"
"    .long   loc_FF92B4FC \n"
"    .long   loc_FF92B518 \n"
"    .long   loc_FF92B524 \n"
"    .long   loc_FF92B55C \n"
"    .long   loc_FF92B594 \n"
"    .long   loc_FF92B5CC \n"
"    .long   loc_FF92B604 \n"
"    .long   loc_FF92B604 \n"
"    .long   loc_FF92B654 \n"
"    .long   loc_FF92B654 \n"
"    .long   loc_FF92B610 \n"
"    .long   loc_FF92B61C \n"

"loc_FF92B4CC:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF92753C \n"
"    B       loc_FF92B650 \n"

"loc_FF92B4D8:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF9277E0 \n"
"    B       loc_FF92B650 \n"

"loc_FF92B4E4:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF927A54 \n"
"    B       loc_FF92B650 \n"

"loc_FF92B4F0:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF927D50 \n"
"    B       loc_FF92B650 \n"

"loc_FF92B4FC:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF927FB4 \n"
"    B       loc_FF92B650 \n"

"loc_FF92B508:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF9281B0_my \n"  // --> Patched. Old value = 0xFF9281B0.
"    MOV     R8, #0 \n"
"    B       loc_FF92B650 \n"

"loc_FF92B518:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF92830C \n"
"    B       loc_FF92B650 \n"

"loc_FF92B524:\n"
"    LDRH    R1, [R2, #4] \n"
"    LDR     R3, =0x51BC8 \n"
"    STRH    R1, [SP, #0x14] \n"
"    LDRH    R1, [R3, #6] \n"
"    STRH    R1, [SP, #0x1A] \n"
"    LDRH    R1, [R3, #2] \n"
"    STRH    R1, [SP, #0x16] \n"
"    LDRH    R3, [R3, #4] \n"
"    STRH    R3, [SP, #0x18] \n"
"    MOV     R0, R2 \n"
"    LDRH    R2, [R2, #0xC] \n"
"    STRH    R2, [SP, #0x1C] \n"
"    BL      sub_FF928608 \n"
"    B       loc_FF92B650 \n"

"loc_FF92B55C:\n"
"    MOV     R0, R2 \n"
"    LDRH    R2, [R2, #4] \n"
"    LDR     R3, =0x51BC8 \n"
"    STRH    R2, [SP, #0x14] \n"
"    LDRH    R2, [R3, #8] \n"
"    STRH    R2, [SP, #0x1C] \n"
"    LDRH    R1, [R3, #2] \n"
"    STRH    R1, [SP, #0x16] \n"
"    LDRH    R2, [R3, #4] \n"
"    STRH    R2, [SP, #0x18] \n"
"    LDRH    R3, [R3, #6] \n"
"    STRH    R3, [SP, #0x1A] \n"
"    BL      sub_FF928730 \n"
"    B       loc_FF92B650 \n"

"loc_FF92B594:\n"
"    LDR     R3, =0x51BC8 \n"
"    LDRH    R1, [R3] \n"
"    STRH    R1, [SP, #0x14] \n"
"    MOV     R0, R2 \n"
"    LDRH    R2, [R2, #6] \n"
"    STRH    R2, [SP, #0x16] \n"
"    LDRH    R2, [R3, #8] \n"
"    STRH    R2, [SP, #0x1C] \n"
"    LDRH    R1, [R3, #4] \n"
"    STRH    R1, [SP, #0x18] \n"
"    LDRH    R3, [R3, #6] \n"
"    STRH    R3, [SP, #0x1A] \n"
"    BL      sub_FF9287F4 \n"
"    B       loc_FF92B650 \n"

"loc_FF92B5CC:\n"
"    LDR     R3, =0x51BC8 \n"
"    LDRH    R1, [R3, #6] \n"
"    STRH    R1, [SP, #0x1A] \n"
"    LDRH    R1, [R3] \n"
"    STRH    R1, [SP, #0x14] \n"
"    LDRH    R1, [R3, #2] \n"
"    STRH    R1, [SP, #0x16] \n"
"    LDRH    R3, [R3, #4] \n"
"    STRH    R3, [SP, #0x18] \n"
"    MOV     R0, R2 \n"
"    LDRH    R2, [R2, #0xC] \n"
"    STRH    R2, [SP, #0x1C] \n"
"    BL      sub_FF9288AC \n"
"    B       loc_FF92B650 \n"

"loc_FF92B604:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF92895C \n"
"    B       loc_FF92B650 \n"

"loc_FF92B610:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF92908C \n"
"    B       loc_FF92B650 \n"

"loc_FF92B61C:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF929288 \n"
"    B       loc_FF92B650 \n"

"loc_FF92B628:\n"
"    MOV     R0, R2 \n"
"    BL      sub_FF929444 \n"
"    B       loc_FF92B650 \n"

"loc_FF92B634:\n"
"    MOV     R0, R2 \n"
"    MOV     R1, #0 \n"
"    BL      sub_FF929628 \n"
"    B       loc_FF92B650 \n"

"loc_FF92B644:\n"
"    MOV     R0, R2 \n"
"    MOV     R1, #1 \n"
"    BL      sub_FF929628 \n"

"loc_FF92B650:\n"
"    LDR     R12, [SP, #4] \n"

"loc_FF92B654:\n"
"    ADD     R0, R12, #4 \n"
"    LDR     R1, [R12, #0x7C] \n"
"    LDR     R2, [R12, #0x8C] \n"
"    MOV     LR, PC \n"
"    LDR     PC, [R12, #0x88] \n"

"loc_FF92B668:\n"
"    CMP     R8, #1 \n"
"    BNE     loc_FF92B690 \n"
"    LDR     R1, [SP, #4] \n"
"    LDR     R3, [R1, #0x7C] \n"
"    ADD     R3, R3, R3, LSL#1 \n"
"    ADD     R1, R1, R3, LSL#2 \n"
"    MOV     R0, R6 \n"
"    SUB     R1, R1, #8 \n"
"    BL      sub_FF9272A0 \n"
"    B       loc_FF92B6C4 \n"

"loc_FF92B690:\n"
"    MOV     R4, #1 \n"
"    MOV     R0, R4 \n"
"    MOV     R1, R4 \n"
"    MOV     R2, R4 \n"
"    MOV     R3, R4 \n"
"    STR     R4, [SP] \n"
"    BL      sub_FF9271F4 \n"
"    MOV     R0, R4 \n"
"    MOV     R1, R0 \n"
"    MOV     R2, R0 \n"
"    MOV     R3, R0 \n"
"    STR     R4, [SP] \n"
"    BL      sub_FF927378 \n"

"loc_FF92B6C4:\n"
"    LDR     R0, [SP, #4] \n"
"    BL      sub_FF926C8C \n"

"loc_FF92B6CC:\n"
"    LDR     R3, =0x51BC0 \n"
"    MOV     R2, #0 \n"
"    LDR     R0, [R3] \n"
"    MOV     R1, R7 \n"
"    BL      sub_FF8213F8 /*_ReceiveMessageQueue*/ \n"
"    LDR     R12, [SP, #4] \n"
"    LDR     R2, [R12] \n"
"    CMP     R2, #0x23 \n"
"    BNE     loc_FF92B220 \n"
"    MOV     R0, R12 \n"
"    BL      sub_FF926C8C \n"
"    LDR     R3, =0x51BBC \n"
"    MOV     R1, #1 \n"
"    LDR     R0, [R3] \n"
"    BL      sub_FF820CE0 /*_SetEventFlag*/ \n"
"    BL      _ExitTask \n"
"    ADD     SP, SP, #0x20 \n"
"    LDMFD   SP!, {R4-R8,PC} \n"
);
}

/*************************************************************/
//** sub_FF9281B0_my @ 0xFF9281B0 - 0xFF9282F4, length=82
void __attribute__((naked,noinline)) sub_FF9281B0_my() {
asm volatile (
"    STMFD   SP!, {R4-R6,LR} \n"
"    LDR     R3, =0x51BBC \n"
"    MOV     R4, R0 \n"
"    MOV     R1, #0x3E \n"
"    LDR     R0, [R3] \n"
"    BL      sub_FF820E7C /*_ClearEventFlag*/ \n"
"    MOV     R1, #0 \n"
"    LDRSH   R0, [R4, #4] \n"
"    BL      sub_FF926DC0 \n"
"    MOV     R6, R0 \n"
"    LDRSH   R0, [R4, #6] \n"
"    BL      sub_FF926F34 \n"
"    LDRSH   R0, [R4, #8] \n"
"    BL      sub_FF926FD0 \n"
"    LDRSH   R0, [R4, #0xA] \n"
"    BL      sub_FF92706C \n"
"    LDRSH   R0, [R4, #0xC] \n"
"    BL      sub_FF927108 \n"
"    LDR     R3, [R4] \n"
"    CMP     R3, #9 \n"
"    MOV     R5, R0 \n"
"    MOVEQ   R5, #0 \n"
"    MOVEQ   R6, R5 \n"
"    CMP     R6, #1 \n"
"    BNE     loc_FF928234 \n"
"    MOV     R2, #2 \n"
"    LDRSH   R0, [R4, #4] \n"
"    LDR     R1, =0xFF926CE0 \n"
"    BL      sub_FFB33974 \n"
"    LDR     R2, =0x51BFC \n"
"    MOV     R3, #0 \n"
"    STR     R3, [R2] \n"
"    B       loc_FF928238 \n"

"loc_FF928234:\n"
"    BL      sub_FF9271A4 \n"

"loc_FF928238:\n"
"    STRH    R0, [R4, #4] \n"
"    CMP     R5, #1 \n"
"    BNE     loc_FF928258 \n"
"    LDRSH   R0, [R4, #0xC] \n"
"    LDR     R1, =0xFF926DA4 \n"
"    MOV     R2, #0x20 \n"
"    BL      sub_FF9274DC \n"
"    B       loc_FF92825C \n"

"loc_FF928258:\n"
"    BL      sub_FF9271E4 \n"

"loc_FF92825C:\n"
"    STRH    R0, [R4, #0xC] \n"
"    LDRSH   R0, [R4, #6] \n"
"    BL      sub_FF8C792C_my \n"  // --> Patched. Old value = 0xFF8C792C.
"    LDRSH   R0, [R4, #8] \n"
"    MOV     R1, #1 \n"
"    BL      sub_FF8C9B90 \n"
"    ADD     R0, R4, #8 \n"
"    MOV     R1, #0 \n"
"    BL      sub_FF8C9C50 \n"
"    LDRSH   R0, [R4, #0xE] \n"
"    BL      sub_FF9148BC \n"
"    CMP     R6, #1 \n"
"    BNE     loc_FF9282C0 \n"
"    LDR     R3, =0x51BBC \n"
"    MOV     R2, #0xBB0 \n"
"    LDR     R0, [R3] \n"
"    MOV     R1, #2 \n"
"    ADD     R2, R2, #8 \n"
"    BL      sub_FF820CD0 /*_WaitForAllEventFlag*/ \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF9282C0 \n"
"    MOV     R1, #0x440 \n"
"    LDR     R0, =0xFF926C38 /*'ExpDrv.c'*/ \n"
"    ADD     R1, R1, #0xB \n"
"    BL      _DebugAssert \n"

"loc_FF9282C0:\n"
"    CMP     R5, #1 \n"
"    LDMNEFD SP!, {R4-R6,PC} \n"
"    LDR     R3, =0x51BBC \n"
"    MOV     R2, #0xBB0 \n"
"    LDR     R0, [R3] \n"
"    MOV     R1, #0x20 \n"
"    ADD     R2, R2, #8 \n"
"    BL      sub_FF820CD0 /*_WaitForAllEventFlag*/ \n"
"    TST     R0, #1 \n"
"    LDMEQFD SP!, {R4-R6,PC} \n"
"    LDR     R0, =0xFF926C38 /*'ExpDrv.c'*/ \n"
"    MOV     R1, #0x450 \n"
"    LDMFD   SP!, {R4-R6,LR} \n"
"    B       _DebugAssert \n"
);
}

/*************************************************************/
//** sub_FF8C792C_my @ 0xFF8C792C - 0xFF8C7988, length=24
void __attribute__((naked,noinline)) sub_FF8C792C_my() {
asm volatile (
"    STMFD   SP!, {R4,LR} \n"
"    LDR     R3, =0x584C \n"
"    LDR     R2, [R3] \n"
"    MOV     R1, #0x150 \n"
"    MOV     R3, R0, LSL#16 \n"
"    CMP     R2, #1 \n"
"    ADD     R1, R1, #1 \n"
"    LDR     R0, =0xFF8C7168 /*'Shutter.c'*/ \n"
"    MOV     R4, R3, ASR#16 \n"
"    BEQ     loc_FF8C7958 \n"
"    BL      _DebugAssert \n"

"loc_FF8C7958:\n"
"    MOV     R1, #0x154 \n"
"    CMN     R4, #0xC00 \n"
"    LDR     R3, =0x363CE \n"
"    LDR     R0, =0xFF8C7168 /*'Shutter.c'*/ \n"
"    ADD     R1, R1, #3 \n"
"    LDREQSH R4, [R3] \n"
"    LDRNE   R3, =0x363CE \n"
"    CMN     R4, #0xC00 \n"
"    STRH    R4, [R3] \n"
"    BNE     loc_FF8C7984 \n"
"    BL      _DebugAssert \n"

"loc_FF8C7984:\n"
"    MOV     R0, R4 \n"
"    BL      apex2us \n"  // --> Patched. Old value = _apex2us.
"    LDR     PC, =0xFF8C798C \n"  // Continue in firmware
);
}
