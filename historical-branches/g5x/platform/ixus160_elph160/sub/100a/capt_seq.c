/*
 * capt_seq.c - auto-generated by CHDK code_gen.
 */
#include "lolevel.h"
#include "platform.h"
#include "core.h"

#define USE_STUBS_NRFLAG 1 // see stubs_min.S

#define NR_AUTO (0)

//#define PAUSE_FOR_FILE_COUNTER 1000  // Enable delay in capt_seq_hook_raw_here to ensure file counter is updated

#include "../../../generic/capt_seq.c"

/*************************************************************/
//** capt_seq_task @ 0xFF88CA84 - 0xFF88CD50, length=180
void __attribute__((naked,noinline)) capt_seq_task() {
asm volatile (
"    STMFD   SP!, {R3-R7,LR} \n"
"    LDR     R5, =0x1CD88 \n"
"    LDR     R7, =0x34F0 \n"
"    MOV     R6, #0 \n"

"loc_FF88CA94:\n"
"    LDR     R0, [R7, #4] \n"
"    MOV     R2, #0 \n"
"    MOV     R1, SP \n"
"    BL      sub_FF829E30 /*_ReceiveMessageQueue*/ \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF88CAC4 \n"
"    LDR     R2, =0x443 \n"
"    LDR     R1, =0xFF88C3F8 /*'SsShootTask.c'*/ \n"
"    MOV     R0, #0 \n"
"    BL      _DebugAssert \n"
"    BL      _ExitTask \n"
"    LDMFD   SP!, {R3-R7,PC} \n"

"loc_FF88CAC4:\n"
"    LDR     R0, [SP] \n"
"    LDR     R0, [R0] \n"
"    CMP     R0, #1 \n"
"    CMPNE   R0, #0x23 \n"
"    CMPNE   R0, #0x19 \n"
"    BLNE    sub_FF99BB58 \n"
"    LDR     R0, [SP] \n"
"    LDR     R1, [R0] \n"
"    CMP     R1, #0x25 \n"
"    ADDCC   PC, PC, R1, LSL#2 \n"
"    B       loc_FF88CD14 \n"
"    B       loc_FF88CB84 \n"
"    B       loc_FF88CB9C \n"
"    B       loc_FF88CBA8 \n"
"    B       loc_FF88CBBC \n"
"    B       loc_FF88CBB4 \n"
"    B       loc_FF88CBC8 \n"
"    B       loc_FF88CBD0 \n"
"    B       loc_FF88CBD8 \n"
"    B       loc_FF88CBE4 \n"
"    B       loc_FF88CC10 \n"
"    B       loc_FF88CBF0 \n"
"    B       loc_FF88CBFC \n"
"    B       loc_FF88CC04 \n"
"    B       loc_FF88CC18 \n"
"    B       loc_FF88CC20 \n"
"    B       loc_FF88CC28 \n"
"    B       loc_FF88CC30 \n"
"    B       loc_FF88CC38 \n"
"    B       loc_FF88CC44 \n"
"    B       loc_FF88CC4C \n"
"    B       loc_FF88CC54 \n"
"    B       loc_FF88CC5C \n"
"    B       loc_FF88CC64 \n"
"    B       loc_FF88CC6C \n"
"    B       loc_FF88CC74 \n"
"    B       loc_FF88CC7C \n"
"    B       loc_FF88CC88 \n"
"    B       loc_FF88CC90 \n"
"    B       loc_FF88CC98 \n"
"    B       loc_FF88CCA0 \n"
"    B       loc_FF88CCA8 \n"
"    B       loc_FF88CCB4 \n"
"    B       loc_FF88CCBC \n"
"    B       loc_FF88CCC8 \n"
"    B       loc_FF88CCF4 \n"
"    B       loc_FF88CD00 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CB84:\n"
"    BL      sub_FF88D2AC \n"
"    BL      shooting_expo_param_override\n"    // added
"    BL      sub_FF88A030 \n"
//To do: Check if this is needed.
//"    MOV     R0, #0\n"                          // added
//"    STR     R0, [R5,#0x28]\n"                  // added, fixes overrides behavior at short shutter press (from S95)
"    LDR     R0, [R5, #0x28] \n"
"    CMP     R0, #0 \n"
"    BLNE    sub_FF99AA5C_my \n"  // --> Patched. Old value = 0xFF99AA5C.
"    B       loc_FF88CD24 \n"

"loc_FF88CB9C:\n"
"    LDR     R0, [R0, #0x10] \n"
"    BL      sub_FF99A7E8_my \n"  // --> Patched. Old value = 0xFF99A7E8.
"    B       loc_FF88CD24 \n"

"loc_FF88CBA8:\n"
"    MOV     R0, #1 \n"
"    BL      sub_FF88D604 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CBB4:\n"
"    BL      sub_FF88CEF8 \n"
"    B       loc_FF88CBC0 \n"

"loc_FF88CBBC:\n"
"    BL      sub_FF88D288 \n"

"loc_FF88CBC0:\n"
"    STR     R6, [R5, #0x28] \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CBC8:\n"
"    BL      sub_FF88D290 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CBD0:\n"
"    BL      sub_FF88D4C8 \n"
"    B       loc_FF88CBE8 \n"

"loc_FF88CBD8:\n"
"    LDR     R0, [R0, #0x10] \n"
"    BL      sub_FF99AB78 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CBE4:\n"
"    BL      sub_FF88D55C \n"

"loc_FF88CBE8:\n"
"    BL      sub_FF88A030 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CBF0:\n"
"    LDR     R0, [R5, #0x54] \n"
"    BL      sub_FF88DBB8 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CBFC:\n"
"    BL      sub_FF88DFF8 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC04:\n"
"    LDR     R0, [R0, #0xC] \n"
"    BL      sub_FF88E060 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC10:\n"
"    BL      sub_FF88D288 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC18:\n"
"    BL      sub_FF9992C0 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC20:\n"
"    BL      sub_FF9994F8 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC28:\n"
"    BL      sub_FF9995B4 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC30:\n"
"    BL      sub_FF99968C \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC38:\n"
"    MOV     R0, #0 \n"
"    BL      sub_FF9998F4 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC44:\n"
"    BL      sub_FF999A54 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC4C:\n"
"    BL      sub_FF893AC8 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC54:\n"
"    BL      sub_FF893AD4 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC5C:\n"
"    BL      sub_FF999AF0 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC64:\n"
"    BL      sub_FF999B9C \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC6C:\n"
"    BL      sub_FF88D74C \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC74:\n"
"    MOV     R0, #0 \n"
"    B       loc_FF88CC80 \n"

"loc_FF88CC7C:\n"
"    LDR     R0, [R0, #0xC] \n"

"loc_FF88CC80:\n"
"    BL      sub_FF88D7D4 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC88:\n"
"    BL      sub_FF99975C \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC90:\n"
"    BL      sub_FF99979C \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CC98:\n"
"    BL      sub_FF8905A0 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CCA0:\n"
"    BL      sub_FF890690 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CCA8:\n"
"    LDR     R0, [R0, #0xC] \n"
"    BL      sub_FF999CAC \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CCB4:\n"
"    BL      sub_FF999D34 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CCBC:\n"
"    BL      sub_FF890820 \n"
"    BL      sub_FF8906E8 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CCC8:\n"
"    BL      sub_FF892778 \n"
"    LDR     R0, =0x1CE88 \n"
"    LDRH    R0, [R0, #0x9C] \n"
"    CMP     R0, #4 \n"
"    LDRNEH  R0, [R5] \n"
"    SUBNE   R1, R0, #0x8200 \n"
"    SUBNES  R1, R1, #0x36 \n"
"    BNE     loc_FF88CD24 \n"
"    BL      sub_FF890690 \n"
"    BL      sub_FF890BB8 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CCF4:\n"
"    MOV     R2, #0 \n"
"    MOV     R1, #0x11 \n"
"    B       loc_FF88CD08 \n"

"loc_FF88CD00:\n"
"    MOV     R2, #0 \n"
"    MOV     R1, #0x10 \n"

"loc_FF88CD08:\n"
"    MOV     R0, #0 \n"
"    BL      sub_FF88AB48 \n"
"    B       loc_FF88CD24 \n"

"loc_FF88CD14:\n"
"    LDR     R2, =0x57B \n"
"    LDR     R1, =0xFF88C3F8 /*'SsShootTask.c'*/ \n"
"    MOV     R0, #0 \n"
"    BL      _DebugAssert \n"

"loc_FF88CD24:\n"
"    LDR     R0, [SP] \n"
"    LDR     R1, [R0, #4] \n"
"    LDR     R0, [R7] \n"
"    BL      sub_FF829BC4 /*_SetEventFlag*/ \n"
"    LDR     R4, [SP] \n"
"    LDR     R0, [R4, #8] \n"
"    CMP     R0, #0 \n"
"    LDREQ   R1, =0xFF88C3F8 /*'SsShootTask.c'*/ \n"
"    MOVEQ   R2, #0x124 \n"
"    BLEQ    _DebugAssert \n"
"    STR     R6, [R4, #8] \n"
"    B       loc_FF88CA94 \n"
);
}

/*************************************************************/
//** sub_FF99AA5C_my @ 0xFF99AA5C - 0xFF99AB40, length=58
void __attribute__((naked,noinline)) sub_FF99AA5C_my() {
asm volatile (
"    STMFD   SP!, {R3-R7,LR} \n"
"    BL      sub_FF88C004 \n"
"    MOV     R4, R0 \n"
"    MOV     R0, #0xC \n"
"    BL      sub_FF892098 \n"
"    LDR     R6, =0x7598 \n"
"    TST     R0, #1 \n"
"    MOV     R5, #1 \n"
"    BNE     loc_FF99AB30 \n"
"    BL      sub_FF8920F4 \n"
"    TST     R0, #1 \n"
"    BNE     loc_FF99AB30 \n"
"    MOV     R2, #2 \n"
"    MOV     R1, SP \n"
"    ADD     R0, R5, #0x108 \n"
"    BL      _GetPropertyCase \n"
"    TST     R0, #1 \n"
"    ADDNE   R2, R5, #0x174 \n"
"    LDRNE   R1, =0xFF99AB58 /*'SsCaptureCtrl.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"
"    LDRSH   R0, [SP] \n"
"    BL      sub_FF82CB64 \n"
"    BL      sub_FF82C980 \n"
"    CMP     R0, #1 \n"
"    BLS     loc_FF99AB38 \n"
"    MOV     R0, #0 \n"
"    BL      sub_FF82CAD8 \n"
"    BL      sub_FF88D298 \n"
"    BL      sub_FF88E388 \n"
"    MOV     R1, R4 \n"
"    BL      sub_FF88E3E4 \n"
"    LDR     R0, =0x10E \n"
"    MOV     R2, #4 \n"
"    ADD     R1, R4, #0x30 \n"
"    BL      _SetPropertyCase \n"
"    MOV     R2, #4 \n"
"    ADD     R1, R4, #0x34 \n"
"    MOV     R0, #0x2C \n"
"    BL      _SetPropertyCase \n"
"    MOV     R2, #4 \n"
"    ADD     R1, R4, #8 \n"
"    MOV     R0, #0x3F \n"
"    BL      _SetPropertyCase \n"
"    BL      sub_FF99B344 \n"
"    MVN     R1, #0x1000 \n"
"    BL      sub_FF829C0C /*_ClearEventFlag*/ \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF99A48C \n"
"    MOV     R0, R4 \n"
"    BL      sub_FFAD7C94_my \n"  // --> Patched. Old value = 0xFFAD7C94.
"    TST     R0, #1 \n"
"    BEQ     loc_FF99AB34 \n"

"loc_FF99AB30:\n"
"    STR     R5, [R6] \n"

"loc_FF99AB34:\n"
"    LDMFD   SP!, {R3-R7,PC} \n"

"loc_FF99AB38:\n"
"    BL      sub_FF88A928 \n"
"    BL      sub_FF892150 \n"
"    LDMFD   SP!, {R3-R7,PC} \n"
);
}

/*************************************************************/
//** sub_FF99A7E8_my @ 0xFF99A7E8 - 0xFF99AA2C, length=146
void __attribute__((naked,noinline)) sub_FF99A7E8_my() {
asm volatile (
"    STMFD   SP!, {R2-R8,LR} \n"
"    LDR     R7, =0x1CD88 \n"
"    MOV     R5, R0 \n"
"    LDR     R0, [R7, #0x28] \n"
"    MOV     R4, #0 \n"
"    CMP     R0, #0 \n"
"    BEQ     loc_FF99A834 \n"
"    LDR     R0, =0x7598 \n"
"    MOV     R2, R5 \n"
"    LDR     R0, [R0] \n"
"    MOV     R1, #2 \n"
"    CMP     R0, #0 \n"
"    MOVNE   R4, #0x1D \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF88AB48 \n"
"    MOV     R1, R4 \n"
"    MOV     R0, R5 \n"
"    BL      sub_FF99B8E0 \n"
"    B       sub_FF99AA50 \n"

"loc_FF99A834:\n"
"    BL      sub_FF88E388 \n"
"    MOV     R1, R5 \n"
"    BL      sub_FF88E3E4 \n"
"    LDR     R0, =0x10E \n"
"    MOV     R2, #4 \n"
"    ADD     R1, R5, #0x30 \n"
"    BL      _SetPropertyCase \n"
"    MOV     R2, #4 \n"
"    ADD     R1, R5, #0x34 \n"
"    MOV     R0, #0x2C \n"
"    BL      _SetPropertyCase \n"
"    LDR     R0, [R7, #0x104] \n"
"    LDR     R6, =0x1CE88 \n"
"    CMP     R0, #0 \n"
"    BNE     loc_FF99A888 \n"
"    LDRH    R0, [R6, #0x9A] \n"
"    CMP     R0, #3 \n"
"    LDRNE   R0, [R5, #8] \n"
"    CMPNE   R0, #1 \n"
"    BHI     loc_FF99A8B8 \n"
"    B       loc_FF99A894 \n"

"loc_FF99A888:\n"
"    LDR     R0, [R5, #0xC] \n"
"    CMP     R0, #1 \n"
"    BNE     loc_FF99A8B8 \n"

"loc_FF99A894:\n"
"    MOV     R0, #0xC \n"
"    BL      sub_FF892098 \n"
"    TST     R0, #1 \n"
"    BNE     loc_FF99A8B0 \n"
"    BL      sub_FF8920F4 \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF99A8B8 \n"

"loc_FF99A8B0:\n"
"    BL      sub_FF88A928 \n"
"    MOV     R4, #1 \n"

"loc_FF99A8B8:\n"
"    TST     R4, #1 \n"
"    BNE     sub_FF99AA34 \n"
"    LDR     R0, [R7, #0xE4] \n"
"    CMP     R0, #0 \n"
"    BEQ     loc_FF99A8F4 \n"
"    LDRH    R0, [R6, #0x9A] \n"
"    CMP     R0, #3 \n"
"    LDRNE   R0, [R5, #8] \n"
"    CMPNE   R0, #1 \n"
"    BHI     loc_FF99A94C \n"
"    LDR     R0, [R7, #0x104] \n"
"    CMP     R0, #0 \n"
"    LDRNE   R0, [R5, #0xC] \n"
"    CMPNE   R0, #1 \n"
"    BHI     loc_FF99A94C \n"

"loc_FF99A8F4:\n"
"    LDR     R0, =0x109 \n"
"    MOV     R2, #2 \n"
"    ADD     R1, SP, #4 \n"
"    BL      _GetPropertyCase \n"
"    TST     R0, #1 \n"
"    MOVNE   R2, #0xCA \n"
"    LDRNE   R1, =0xFF99AB58 /*'SsCaptureCtrl.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"
"    LDRSH   R0, [SP, #4] \n"
"    BL      sub_FF82CB64 \n"
"    BL      sub_FF82C980 \n"
"    CMP     R0, #1 \n"
"    BLS     loc_FF99A938 \n"
"    MOV     R0, #0 \n"
"    BL      sub_FF82CAD8 \n"
"    B       loc_FF99A94C \n"

"loc_FF99A938:\n"
"    BL      sub_FF88A928 \n"
"    BL      sub_FF892150 \n"
"    MOV     R4, #1 \n"
"    CMP     R4, #0 \n"
"    BNE     sub_FF99AA34 \n"

"loc_FF99A94C:\n"
"    BL      sub_FF99B344 \n"
"    MVN     R1, #0x1000 \n"
"    BL      sub_FF829C0C /*_ClearEventFlag*/ \n"
"    MOV     R0, R5 \n"
"    BL      sub_FFAD78EC \n"
"    TST     R0, #1 \n"
"    MOV     R4, R0 \n"
"    BNE     sub_FF99AA34 \n"
"    BL      sub_FF88D298 \n"
"    MOV     R0, R5 \n"
"    BL      sub_FF99A48C \n"
"    LDR     R0, [R7, #0xA0] \n"
"    CMP     R0, #0 \n"
"    BEQ     loc_FF99AA14 \n"
"    LDRH    R0, [R6, #0x9A] \n"
"    CMP     R0, #3 \n"
"    LDRNE   R0, [R5, #8] \n"
"    CMPNE   R0, #1 \n"
"    BLS     loc_FF99A9B4 \n"
"    BL      sub_FF99B344 \n"
"    LDR     R3, =0x11A \n"
"    LDR     R2, =0x3A98 \n"
"    STR     R3, [SP] \n"
"    LDR     R3, =0xFF99AB58 /*'SsCaptureCtrl.c'*/ \n"
"    MOV     R1, #0x1000 \n"
"    BL      sub_FF89237C \n"

"loc_FF99A9B4:\n"
"    MOV     R2, #4 \n"
"    ADD     R1, SP, #4 \n"
"    MOV     R0, #0x180 \n"
"    BL      _GetPropertyCase \n"
"    TST     R0, #1 \n"
"    LDRNE   R2, =0x11E \n"
"    LDRNE   R1, =0xFF99AB58 /*'SsCaptureCtrl.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"
"    LDR     R0, [SP, #4] \n"
"    CMP     R0, #0 \n"
"    BNE     loc_FF99A9F4 \n"
"    BL      sub_FF99B344 \n"
"    MOV     R1, #0x1000 \n"
"    BL      sub_FF829BC4 /*_SetEventFlag*/ \n"
"    B       loc_FF99AA14 \n"

"loc_FF99A9F4:\n"
"    BL      sub_FF99B344 \n"
"    MOV     R1, #0x1000 \n"
"    BL      sub_FF829C0C /*_ClearEventFlag*/ \n"
"    LDR     R2, =0xFF99A7D4 \n"
"    LDR     R0, [SP, #4] \n"
"    MOV     R3, #0x1000 \n"
"    MOV     R1, R2 \n"
"    BL      sub_FF826A9C /*_SetTimerAfter*/ \n"

"loc_FF99AA14:\n"
"    LDR     R0, [R7, #0xAC] \n"
"    CMP     R0, #0 \n"
"    MOV     R0, R5 \n"
"    BEQ     loc_FF99AA2C \n"
"    BL      sub_FFAD80B0 \n"
"    B       sub_FF99AA50 \n"

"loc_FF99AA2C:\n"
"    BL      sub_FFAD7C94_my \n"  // --> Patched. Old value = 0xFFAD7C94.
"    LDR     PC, =0xFF99AA30 \n"  // Continue in firmware
);
}

/*************************************************************/
//** sub_FFAD7C94_my @ 0xFFAD7C94 - 0xFFAD7F18, length=162
void __attribute__((naked,noinline)) sub_FFAD7C94_my() {
asm volatile (
"    STMFD   SP!, {R2-R10,LR} \n"
"    MOV     R4, R0 \n"
"    BL      sub_FF99A3F4 \n"
"    BL      sub_FF99B1A0 \n"
"    LDR     R7, =0x1CD88 \n"
"    LDR     R0, [R7, #0x190] \n"
"    CMP     R0, #2 \n"
"    BNE     loc_FFAD7CD0 \n"
"    ADD     R0, R7, #0x100 \n"
"    LDRH    R0, [R0, #0x9A] \n"
"    CMP     R0, #3 \n"
"    LDRNE   R0, [R4, #8] \n"
"    CMPNE   R0, #1 \n"
"    MOVLS   R0, #4 \n"
"    BLLS    sub_FF90CF8C \n"

"loc_FFAD7CD0:\n"
"    LDR     R0, =0x12F \n"
"    MOV     R2, #4 \n"
"    ADD     R1, SP, #4 \n"
"    BL      _GetPropertyCase \n"
"    TST     R0, #1 \n"
"    LDRNE   R2, =0x191 \n"
"    LDRNE   R1, =0xFFAD7F40 /*'SsStandardCaptureSeq.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"
"    LDR     R0, [SP, #4] \n"
"    AND     R0, R0, #0xFF00 \n"
"    CMP     R0, #0x600 \n"
"    LDRNE   R0, =0xFF99A090 \n"
"    LDREQ   R0, =0xFFAD7C10 \n"
"    MOVNE   R1, R4 \n"
"    MOVEQ   R1, #0 \n"
"    BL      sub_FF8CC134 \n"
"    LDR     R0, [R7, #0x184] \n"
"    CMP     R0, #0 \n"
"    BLNE    sub_FF99A2E0 \n"
"    MOV     R0, #0 \n"
//"  BL      _sub_FF88F668 \n"  // --> Nullsub call removed.
"    MOV     R0, R4 \n"
"    BL      sub_FF99A51C_my \n"  // --> Patched. Old value = 0xFF99A51C.
"    LDR     R1, =0xCA1C \n"
"    MOV     R2, #4 \n"
"    MOV     R0, #0x8A \n"
"    BL      _GetPropertyCase \n"
"    TST     R0, #1 \n"
"    LDRNE   R2, =0x1A5 \n"
"    LDRNE   R1, =0xFFAD7F40 /*'SsStandardCaptureSeq.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"
"    BL      sub_FF88F818 \n"
"    BL      sub_FF87F79C \n"
"    MOV     R1, #0 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FFAD7C14 \n"
"    MOV     R6, R0 \n"
"    LDR     R0, [SP, #4] \n"
"    LDR     R8, =0xCA1C \n"
"    AND     R0, R0, #0xFF00 \n"
"    CMP     R0, #0x600 \n"
"    LDRH    R0, [R4, #0x18] \n"
"    LDRNE   R2, =0xFF99A2C8 \n"
"    LDREQ   R2, =0xFF99A23C \n"
"    CMP     R0, #0 \n"
"    BEQ     loc_FFAD7DA0 \n"
"    CMP     R0, #1 \n"
"    BEQ     loc_FFAD7DC4 \n"
"    CMP     R0, #4 \n"
"    BNE     loc_FFAD7E38 \n"

"loc_FFAD7DA0:\n"
"    STR     R6, [SP] \n"
"    MOV     R3, R2 \n"
"    LDR     R1, [R4, #0x34] \n"
"    LDR     R2, [R8] \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF999E38 \n"
"    MOV     R5, R0 \n"
"    BL      sub_FF8C8A5C \n"
"    B       loc_FFAD7E4C \n"

"loc_FFAD7DC4:\n"
"    STR     R6, [SP] \n"
"    MOV     R3, R2 \n"
"    LDR     R1, [R4, #0x34] \n"
"    LDR     R2, [R8] \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF999EC4 \n"
"    MOV     R5, R0 \n"
"    MOV     R1, #0 \n"
"    MOV     R0, #0x45 \n"
"    BL      sub_FF833F7C \n"
"    TST     R5, #1 \n"
"    BNE     loc_FFAD7E4C \n"
"    LDR     R0, =0xFFAD7C10 \n"
"    MOV     R1, #0 \n"
"    BL      sub_FF8CC134 \n"
"    MOV     R1, #1 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FFAD7C14 \n"
"    MOV     R6, R0 \n"
"    LDR     R0, [R8] \n"
"    BL      sub_FF99A378 \n"
"    LDR     R1, [R4, #0x34] \n"
"    LDR     R2, [R8] \n"
"    MOV     R3, R6 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF999F5C \n"
"    MOV     R5, R0 \n"
"    BL      sub_FF999DC0 \n"
"    B       loc_FFAD7E4C \n"

"loc_FFAD7E38:\n"
"    MOV     R2, #0x1D8 \n"
"    LDR     R1, =0xFFAD7F40 /*'SsStandardCaptureSeq.c'*/ \n"
"    MOV     R0, #0 \n"
"    BL      _DebugAssert \n"
"    MOV     R5, #0x1D \n"

"loc_FFAD7E4C:\n"
"    BL      sub_FF87F7B4 \n"
"    LDR     R8, =0xFFAD7C10 \n"
"    TST     R5, #1 \n"
"    BNE     loc_FFAD7ECC \n"
"    LDR     R0, [R7, #0x100] \n"
"    CMP     R0, #0 \n"
"    BNE     loc_FFAD7E84 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF99C0E4 \n"
"    TST     R0, #1 \n"
"    LDRNE   R2, =0x1FD \n"
"    LDRNE   R1, =0xFFAD7F40 /*'SsStandardCaptureSeq.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"
"    BL      capt_seq_hook_raw_here \n"         // added

"loc_FFAD7E84:\n"
"    MOV     R0, R4 \n"
"    BL      sub_FF99A604 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF99A5BC \n"
"    CMP     R6, R8 \n"
"    BEQ     loc_FFAD7ECC \n"
"    BL      sub_FF99B344 \n"
"    LDR     R9, =0x20A \n"
"    LDR     R2, =0x3A98 \n"
"    LDR     R3, =0xFFAD7F40 /*'SsStandardCaptureSeq.c'*/ \n"
"    MOV     R1, #4 \n"
"    STR     R9, [SP] \n"
"    BL      sub_FF89237C \n"
"    CMP     R0, #0 \n"
"    MOVNE   R2, R9 \n"
"    LDRNE   R1, =0xFFAD7F40 /*'SsStandardCaptureSeq.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"

"loc_FFAD7ECC:\n"
"    MOV     R2, R4 \n"
"    MOV     R1, #2 \n"
"    MOV     R0, R5 \n"
"    BL      sub_FF88AB48 \n"
"    LDR     R0, [R7, #0x28] \n"
"    CMP     R0, #0 \n"
"    BEQ     loc_FFAD7F00 \n"
"    SUBS    R1, R6, R8 \n"
"    MOVNE   R1, #1 \n"
"    MOV     R2, R5 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF99B878 \n"
"    B       loc_FFAD7F14 \n"

"loc_FFAD7F00:\n"
"    SUBS    R1, R6, R8 \n"
"    MOVNE   R1, #1 \n"
"    MOV     R2, R5 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF99B80C \n"

"loc_FFAD7F14:\n"
"    MOV     R0, R5 \n"
"    LDMFD   SP!, {R2-R10,PC} \n"
"    .ltorg\n"         // added
);
}

/*************************************************************/
//** sub_FF99A51C_my @ 0xFF99A51C - 0xFF99A55C, length=17
void __attribute__((naked,noinline)) sub_FF99A51C_my() {
asm volatile (
"    STMFD   SP!, {R4-R6,LR} \n"
"    MOV     R4, R0 \n"
"    LDR     R0, =0x1CD88 \n"
"    LDR     R5, =0x7590 \n"
"    LDR     R0, [R0, #0xF4] \n"
"    CMP     R0, #0 \n"
"    LDRNE   R0, =0x1CE88 \n"
"    LDRNEH  R0, [R0, #0x9A] \n"
"    CMPNE   R0, #3 \n"
"    LDRNE   R0, [R4, #8] \n"
"    CMPNE   R0, #1 \n"
"    BHI     loc_FF99A55C \n"
"    LDR     R1, [R4, #0x1C] \n"
"    MOV     R0, #0 \n"
"    BL      sub_FFA29B24 \n"
"    STR     R0, [R5] \n"

"loc_FF99A55C:\n"
"    BL      wait_until_remote_button_is_released\n" // added
"    BL      capt_seq_hook_set_nr\n"                 // added
"    LDR     R0, [R4, #0x20] \n"
"    LDR     PC, =0xFF99A560 \n"  // Continue in firmware
);
}

/*************************************************************/
//** exp_drv_task @ 0xFF8DB0B0 - 0xFF8DB74C, length=424
void __attribute__((naked,noinline)) exp_drv_task() {
asm volatile (
"    STMFD   SP!, {R4-R9,LR} \n"
"    SUB     SP, SP, #0x2C \n"
"    LDR     R6, =0x43DC \n"
"    LDR     R7, =0xBB8 \n"
"    LDR     R4, =0x5BE18 \n"
"    MOV     R0, #0 \n"
"    ADD     R5, SP, #0x1C \n"
"    STR     R0, [SP, #0xC] \n"

"loc_FF8DB0D0:\n"
"    LDR     R0, [R6, #0x20] \n"
"    MOV     R2, #0 \n"
"    ADD     R1, SP, #0x28 \n"
"    BL      sub_FF829E30 /*_ReceiveMessageQueue*/ \n"
"    LDR     R0, [SP, #0xC] \n"
"    CMP     R0, #1 \n"
"    BNE     loc_FF8DB120 \n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R0, [R0] \n"
"    CMP     R0, #0x14 \n"
"    CMPNE   R0, #0x15 \n"
"    CMPNE   R0, #0x16 \n"
"    CMPNE   R0, #0x17 \n"
"    CMPNE   R0, #0x18 \n"
"    BEQ     loc_FF8DB284 \n"
"    CMP     R0, #0x2E \n"
"    BEQ     loc_FF8DB208 \n"
"    ADD     R1, SP, #0xC \n"
"    MOV     R0, #0 \n"
"    BL      sub_FF8DB050 \n"

"loc_FF8DB120:\n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R1, [R0] \n"
"    CMP     R1, #0x34 \n"
"    BNE     loc_FF8DB14C \n"
"    BL      sub_FF8DC8F0 \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R1, #1 \n"
"    BL      sub_FF829BC4 /*_SetEventFlag*/ \n"
"    BL      _ExitTask \n"
"    ADD     SP, SP, #0x2C \n"
"    LDMFD   SP!, {R4-R9,PC} \n"

"loc_FF8DB14C:\n"
"    CMP     R1, #0x33 \n"
"    BNE     loc_FF8DB168 \n"
"    LDR     R2, [R0, #0xAC]! \n"
"    LDR     R1, [R0, #4] \n"
"    MOV     R0, R1 \n"
"    BLX     R2 \n"
"    B       loc_FF8DB744 \n"

"loc_FF8DB168:\n"
"    CMP     R1, #0x2C \n"
"    BNE     loc_FF8DB1B8 \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R1, #0x80 \n"
"    BL      sub_FF829C0C /*_ClearEventFlag*/ \n"
"    LDR     R0, =0xFF8D6454 \n"
"    MOV     R1, #0x80 \n"
"    BL      sub_FF887A8C \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R2, R7 \n"
"    MOV     R1, #0x80 \n"
"    BL      sub_FF829AF8 /*_WaitForAllEventFlag*/ \n"
"    TST     R0, #1 \n"
"    LDRNE   R2, =0x1798 \n"
"    BNE     loc_FF8DB274 \n"

"loc_FF8DB1A4:\n"
"    LDR     R1, [SP, #0x28] \n"
"    LDR     R0, [R1, #0xB0] \n"
"    LDR     R1, [R1, #0xAC] \n"
"    BLX     R1 \n"
"    B       loc_FF8DB744 \n"

"loc_FF8DB1B8:\n"
"    CMP     R1, #0x2D \n"
"    BNE     loc_FF8DB200 \n"
"    ADD     R1, SP, #0xC \n"
"    BL      sub_FF8DB050 \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R1, #0x100 \n"
"    BL      sub_FF829C0C /*_ClearEventFlag*/ \n"
"    LDR     R0, =0xFF8D6464 \n"
"    MOV     R1, #0x100 \n"
"    BL      sub_FF887CA4 \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R2, R7 \n"
"    MOV     R1, #0x100 \n"
"    BL      sub_FF829AF8 /*_WaitForAllEventFlag*/ \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF8DB1A4 \n"
"    LDR     R2, =0x17A2 \n"
"    B       loc_FF8DB274 \n"

"loc_FF8DB200:\n"
"    CMP     R1, #0x2E \n"
"    BNE     loc_FF8DB218 \n"

"loc_FF8DB208:\n"
"    LDR     R0, [SP, #0x28] \n"
"    ADD     R1, SP, #0xC \n"
"    BL      sub_FF8DB050 \n"
"    B       loc_FF8DB1A4 \n"

"loc_FF8DB218:\n"
"    CMP     R1, #0x31 \n"
"    BNE     loc_FF8DB230 \n"
"    BL      sub_FF8C3658 \n"
"    BL      sub_FF8C44D0 \n"
"    BL      sub_FF8C3FB0 \n"
"    B       loc_FF8DB1A4 \n"

"loc_FF8DB230:\n"
"    CMP     R1, #0x32 \n"
"    BNE     loc_FF8DB284 \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R1, #4 \n"
"    BL      sub_FF829C0C /*_ClearEventFlag*/ \n"
"    LDR     R1, =0xFF8D6484 \n"
"    LDR     R0, =0xFFFFF400 \n"
"    MOV     R2, #4 \n"
"    BL      sub_FF8DC954 \n"
"    BL      sub_FF8C32EC \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R2, R7 \n"
"    MOV     R1, #4 \n"
"    BL      sub_FF829A0C /*_WaitForAnyEventFlag*/ \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF8DB1A4 \n"
"    LDR     R2, =0x17DA \n"

"loc_FF8DB274:\n"
"    LDR     R1, =0xFF8D6C20 /*'ExpDrv.c'*/ \n"
"    MOV     R0, #0 \n"
"    BL      _DebugAssert \n"
"    B       loc_FF8DB1A4 \n"

"loc_FF8DB284:\n"
"    LDR     R0, [SP, #0x28] \n"
"    MOV     R8, #1 \n"
"    LDR     R1, [R0] \n"
"    CMP     R1, #0x12 \n"
"    CMPNE   R1, #0x13 \n"
"    BNE     loc_FF8DB2EC \n"
"    LDR     R1, [R0, #0x94] \n"
"    ADD     R1, R1, R1, LSL#1 \n"
"    ADD     R1, R0, R1, LSL#2 \n"
"    SUB     R1, R1, #8 \n"
"    LDMIA   R1, {R2,R3,R9} \n"
"    STMIA   R5, {R2,R3,R9} \n"
"    BL      sub_FF8D949C \n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R1, [R0, #0x94] \n"
"    LDR     R3, [R0, #0xAC] \n"
"    LDR     R2, [R0, #0xB0] \n"
"    ADD     R0, R0, #4 \n"
"    BLX     R3 \n"
"    LDR     R0, [SP, #0x28] \n"
"    BL      sub_FF8DCC3C \n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R1, [R0, #0x94] \n"
"    LDR     R2, [R0, #0xB8] \n"
"    LDR     R3, [R0, #0xB4] \n"
"    B       loc_FF8DB608 \n"

"loc_FF8DB2EC:\n"
"    CMP     R1, #0x14 \n"
"    CMPNE   R1, #0x15 \n"
"    CMPNE   R1, #0x16 \n"
"    CMPNE   R1, #0x17 \n"
"    CMPNE   R1, #0x18 \n"
"    BNE     loc_FF8DB398 \n"
"    ADD     R3, SP, #0xC \n"
"    MOV     R2, SP \n"
"    ADD     R1, SP, #0x1C \n"
"    BL      sub_FF8D970C \n"
"    CMP     R0, #1 \n"
"    MOV     R9, R0 \n"
"    CMPNE   R9, #5 \n"
"    BNE     loc_FF8DB344 \n"
"    LDR     R0, [SP, #0x28] \n"
"    MOV     R2, R9 \n"
"    LDR     R1, [R0, #0x94] \n"
"    LDR     R12, [R0, #0xAC] \n"
"    LDR     R3, [R0, #0xB0] \n"
"    ADD     R0, R0, #4 \n"
"    BLX     R12 \n"
"    B       loc_FF8DB37C \n"

"loc_FF8DB344:\n"
"    LDR     R0, [SP, #0x28] \n"
"    CMP     R9, #2 \n"
"    LDR     R1, [R0, #0x94] \n"
"    LDR     R12, [R0, #0xAC] \n"
"    LDR     R3, [R0, #0xB0] \n"
"    CMPNE   R9, #6 \n"
"    MOV     R2, R9 \n"
"    ADD     R0, R0, #4 \n"
"    BNE     loc_FF8DB390 \n"
"    BLX     R12 \n"
"    LDR     R0, [SP, #0x28] \n"
"    MOV     R2, SP \n"
"    ADD     R1, SP, #0x1C \n"
"    BL      sub_FF8DAD5C \n"

"loc_FF8DB37C:\n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R2, [SP, #0xC] \n"
"    MOV     R1, R9 \n"
"    BL      sub_FF8DAFE0 \n"
"    B       loc_FF8DB610 \n"

"loc_FF8DB390:\n"
"    BLX     R12 \n"
"    B       loc_FF8DB610 \n"

"loc_FF8DB398:\n"
"    CMP     R1, #0x28 \n"
"    CMPNE   R1, #0x29 \n"
"    BNE     loc_FF8DB3E4 \n"
"    LDR     R1, [R0, #0x94] \n"
"    ADD     R1, R1, R1, LSL#1 \n"
"    ADD     R1, R0, R1, LSL#2 \n"
"    SUB     R1, R1, #8 \n"
"    LDMIA   R1, {R2,R3,R9} \n"
"    STMIA   R5, {R2,R3,R9} \n"
"    BL      sub_FF8D83C8 \n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R1, [R0, #0x94] \n"
"    LDR     R3, [R0, #0xAC] \n"
"    LDR     R2, [R0, #0xB0] \n"
"    ADD     R0, R0, #4 \n"
"    BLX     R3 \n"
"    LDR     R0, [SP, #0x28] \n"
"    BL      sub_FF8D8818 \n"
"    B       loc_FF8DB610 \n"

"loc_FF8DB3E4:\n"
"    ADD     R1, R0, #4 \n"
"    LDMIA   R1, {R2,R3,R9} \n"
"    STMIA   R5, {R2,R3,R9} \n"
"    LDR     R1, [R0] \n"
"    CMP     R1, #0x2C \n"
"    ADDCC   PC, PC, R1, LSL#2 \n"
"    B       loc_FF8DB5F8 \n"
"    B       loc_FF8DB4B0 \n"
"    B       loc_FF8DB4B0 \n"
"    B       loc_FF8DB4B8 \n"
"    B       loc_FF8DB4C0 \n"
"    B       loc_FF8DB4C0 \n"
"    B       loc_FF8DB4C0 \n"
"    B       loc_FF8DB4B0 \n"
"    B       loc_FF8DB4B8 \n"
"    B       loc_FF8DB4C0 \n"
"    B       loc_FF8DB4C0 \n"
"    B       loc_FF8DB4D8 \n"
"    B       loc_FF8DB4D8 \n"
"    B       loc_FF8DB5E4 \n"
"    B       loc_FF8DB5EC \n"
"    B       loc_FF8DB5EC \n"
"    B       loc_FF8DB5EC \n"
"    B       loc_FF8DB5EC \n"
"    B       loc_FF8DB5F4 \n"
"    B       loc_FF8DB5F8 \n"
"    B       loc_FF8DB5F8 \n"
"    B       loc_FF8DB5F8 \n"
"    B       loc_FF8DB5F8 \n"
"    B       loc_FF8DB5F8 \n"
"    B       loc_FF8DB5F8 \n"
"    B       loc_FF8DB5F8 \n"
"    B       loc_FF8DB4C8 \n"
"    B       loc_FF8DB4D0 \n"
"    B       loc_FF8DB4D0 \n"
"    B       loc_FF8DB4D0 \n"
"    B       loc_FF8DB4E4 \n"
"    B       loc_FF8DB4E4 \n"
"    B       loc_FF8DB4E4 \n"
"    B       loc_FF8DB4EC \n"
"    B       loc_FF8DB524 \n"
"    B       loc_FF8DB5F8 \n"
"    B       loc_FF8DB5F8 \n"
"    B       loc_FF8DB55C \n"
"    B       loc_FF8DB594 \n"
"    B       loc_FF8DB5CC \n"
"    B       loc_FF8DB5CC \n"
"    B       loc_FF8DB5F8 \n"
"    B       loc_FF8DB5F8 \n"
"    B       loc_FF8DB5D4 \n"
"    B       loc_FF8DB5DC \n"

"loc_FF8DB4B0:\n"
"    BL      sub_FF8D6AA0 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB4B8:\n"
"    BL      sub_FF8D6D6C \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB4C0:\n"
"    BL      sub_FF8D6FAC \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB4C8:\n"
"    BL      sub_FF8D72F4 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB4D0:\n"
"    BL      sub_FF8D7524 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB4D8:\n"
"    BL      sub_FF8D7914_my \n"  // --> Patched. Old value = 0xFF8D7914.
"    MOV     R8, #0 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB4E4:\n"
"    BL      sub_FF8D7AE8 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB4EC:\n"
"    LDRH    R1, [R0, #4] \n"
"    STRH    R1, [SP, #0x1C] \n"
"    LDRH    R1, [R4, #2] \n"
"    STRH    R1, [SP, #0x1E] \n"
"    LDRH    R1, [R4, #4] \n"
"    STRH    R1, [SP, #0x20] \n"
"    LDRH    R1, [R4, #6] \n"
"    STRH    R1, [SP, #0x22] \n"
"    LDRH    R1, [R0, #0xC] \n"
"    STRH    R1, [SP, #0x24] \n"
"    LDRH    R1, [R4, #0xA] \n"
"    STRH    R1, [SP, #0x26] \n"
"    BL      sub_FF8D8050 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB524:\n"
"    LDRH    R1, [R0, #4] \n"
"    STRH    R1, [SP, #0x1C] \n"
"    LDRH    R1, [R4, #2] \n"
"    STRH    R1, [SP, #0x1E] \n"
"    LDRH    R1, [R4, #4] \n"
"    STRH    R1, [SP, #0x20] \n"
"    LDRH    R1, [R4, #6] \n"
"    STRH    R1, [SP, #0x22] \n"
"    LDRH    R1, [R4, #8] \n"
"    STRH    R1, [SP, #0x24] \n"
"    LDRH    R1, [R4, #0xA] \n"
"    STRH    R1, [SP, #0x26] \n"
"    BL      sub_FF8DC9B4 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB55C:\n"
"    LDRH    R1, [R4] \n"
"    STRH    R1, [SP, #0x1C] \n"
"    LDRH    R1, [R0, #6] \n"
"    STRH    R1, [SP, #0x1E] \n"
"    LDRH    R1, [R4, #4] \n"
"    STRH    R1, [SP, #0x20] \n"
"    LDRH    R1, [R4, #6] \n"
"    STRH    R1, [SP, #0x22] \n"
"    LDRH    R1, [R4, #8] \n"
"    STRH    R1, [SP, #0x24] \n"
"    LDRH    R1, [R4, #0xA] \n"
"    STRH    R1, [SP, #0x26] \n"
"    BL      sub_FF8DCAE8 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB594:\n"
"    LDRH    R1, [R4] \n"
"    STRH    R1, [SP, #0x1C] \n"
"    LDRH    R1, [R4, #2] \n"
"    STRH    R1, [SP, #0x1E] \n"
"    LDRH    R1, [R4, #4] \n"
"    STRH    R1, [SP, #0x20] \n"
"    LDRH    R1, [R4, #6] \n"
"    STRH    R1, [SP, #0x22] \n"
"    LDRH    R1, [R0, #0xC] \n"
"    STRH    R1, [SP, #0x24] \n"
"    LDRH    R1, [R4, #0xA] \n"
"    STRH    R1, [SP, #0x26] \n"
"    BL      sub_FF8DCB94 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB5CC:\n"
"    BL      sub_FF8D8164 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB5D4:\n"
"    BL      sub_FF8D8930 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB5DC:\n"
"    BL      sub_FF8D8CC8 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB5E4:\n"
"    BL      sub_FF8D8F38 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB5EC:\n"
"    BL      sub_FF8D9104 \n"
"    B       loc_FF8DB5F8 \n"

"loc_FF8DB5F4:\n"
"    BL      sub_FF8D927C \n"

"loc_FF8DB5F8:\n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R1, [R0, #0x94] \n"
"    LDR     R2, [R0, #0xB0] \n"
"    LDR     R3, [R0, #0xAC] \n"

"loc_FF8DB608:\n"
"    ADD     R0, R0, #4 \n"
"    BLX     R3 \n"

"loc_FF8DB610:\n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R0, [R0] \n"
"    CMP     R0, #0x10 \n"
"    BEQ     loc_FF8DB648 \n"
"    BGT     loc_FF8DB638 \n"
"    CMP     R0, #1 \n"
"    CMPNE   R0, #4 \n"
"    CMPNE   R0, #0xE \n"
"    BNE     loc_FF8DB67C \n"
"    B       loc_FF8DB648 \n"

"loc_FF8DB638:\n"
"    CMP     R0, #0x13 \n"
"    CMPNE   R0, #0x18 \n"
"    CMPNE   R0, #0x1B \n"
"    BNE     loc_FF8DB67C \n"

"loc_FF8DB648:\n"
"    LDRSH   R0, [R4] \n"
"    CMN     R0, #0xC00 \n"
"    LDRNESH R1, [R4, #8] \n"
"    CMNNE   R1, #0xC00 \n"
"    STRNEH  R0, [SP, #0x1C] \n"
"    STRNEH  R1, [SP, #0x24] \n"
"    BNE     loc_FF8DB67C \n"
"    ADD     R0, SP, #0x10 \n"
"    BL      sub_FF8DCE6C \n"
"    LDRH    R0, [SP, #0x10] \n"
"    STRH    R0, [SP, #0x1C] \n"
"    LDRH    R0, [SP, #0x18] \n"
"    STRH    R0, [SP, #0x24] \n"

"loc_FF8DB67C:\n"
"    LDR     R0, [SP, #0x28] \n"
"    CMP     R8, #1 \n"
"    BNE     loc_FF8DB6CC \n"
"    LDR     R1, [R0, #0x94] \n"
"    MOV     R2, #0xC \n"
"    ADD     R1, R1, R1, LSL#1 \n"
"    ADD     R0, R0, R1, LSL#2 \n"
"    SUB     R8, R0, #8 \n"
"    LDR     R0, =0x5BE18 \n"
"    ADD     R1, SP, #0x1C \n"
"    BL      sub_006BA828 \n"
"    LDR     R0, =0x5BE24 \n"
"    MOV     R2, #0xC \n"
"    ADD     R1, SP, #0x1C \n"
"    BL      sub_006BA828 \n"
"    LDR     R0, =0x5BE30 \n"
"    MOV     R2, #0xC \n"
"    MOV     R1, R8 \n"
"    BL      sub_006BA828 \n"
"    B       loc_FF8DB744 \n"

"loc_FF8DB6CC:\n"
"    LDR     R0, [R0] \n"
"    MOV     R3, #1 \n"
"    CMP     R0, #0xB \n"
"    BNE     loc_FF8DB710 \n"
"    MOV     R2, #0 \n"
"    STRD    R2, [SP] \n"
"    MOV     R2, R3 \n"
"    MOV     R1, R3 \n"
"    MOV     R0, #0 \n"
"    BL      sub_FF8D686C \n"
"    MOV     R3, #1 \n"
"    MOV     R2, #0 \n"
"    STRD    R2, [SP] \n"
"    MOV     R2, R3 \n"
"    MOV     R1, R3 \n"
"    MOV     R0, #0 \n"
"    B       loc_FF8DB740 \n"

"loc_FF8DB710:\n"
"    MOV     R2, #1 \n"
"    STRD    R2, [SP] \n"
"    MOV     R3, R2 \n"
"    MOV     R1, R2 \n"
"    MOV     R0, R2 \n"
"    BL      sub_FF8D686C \n"
"    MOV     R3, #1 \n"
"    MOV     R2, R3 \n"
"    MOV     R1, R3 \n"
"    MOV     R0, R3 \n"
"    STR     R3, [SP] \n"
"    STR     R3, [SP, #4] \n"

"loc_FF8DB740:\n"
"    BL      sub_FF8D69E8 \n"

"loc_FF8DB744:\n"
"    LDR     R0, [SP, #0x28] \n"
"    BL      sub_FF8DC8F0 \n"
"    B       loc_FF8DB0D0 \n"
);
}

/*************************************************************/
//** sub_FF8D7914_my @ 0xFF8D7914 - 0xFF8D79D8, length=50
void __attribute__((naked,noinline)) sub_FF8D7914_my() {
asm volatile (
"    STMFD   SP!, {R4-R8,LR} \n"
"    LDR     R7, =0x43DC \n"
"    MOV     R4, R0 \n"
"    LDR     R0, [R7, #0x1C] \n"
"    MOV     R1, #0x3E \n"
"    BL      sub_FF829C0C /*_ClearEventFlag*/ \n"
"    MOV     R2, #0 \n"
"    LDRSH   R0, [R4, #4] \n"
"    MOV     R3, #1 \n"
"    MOV     R1, R2 \n"
"    BL      sub_FF8D64EC \n"
"    MOV     R6, R0 \n"
"    LDRSH   R0, [R4, #6] \n"
"    BL      sub_FF8D66CC \n"
"    LDRSH   R0, [R4, #8] \n"
"    BL      sub_FF8D6724 \n"
"    LDRSH   R0, [R4, #0xA] \n"
"    BL      sub_FF8D677C \n"
"    LDRSH   R0, [R4, #0xC] \n"
"    MOV     R1, #0 \n"
"    BL      sub_FF8D67D4 \n"
"    MOV     R5, R0 \n"
"    LDR     R0, [R4] \n"
"    LDR     R8, =0x5BE30 \n"
"    CMP     R0, #0xB \n"
"    MOVEQ   R6, #0 \n"
"    MOVEQ   R5, R6 \n"
"    BEQ     loc_FF8D79AC \n"
"    CMP     R6, #1 \n"
"    BNE     loc_FF8D79AC \n"
"    LDRSH   R0, [R4, #4] \n"
"    LDR     R1, =0xFF8D6444 \n"
"    MOV     R2, #2 \n"
"    BL      sub_FF887B18 \n"
"    STRH    R0, [R4, #4] \n"
"    MOV     R0, #0 \n"
"    STR     R0, [R7, #0x28] \n"
"    B       loc_FF8D79B4 \n"

"loc_FF8D79AC:\n"
"    LDRH    R0, [R8] \n"
"    STRH    R0, [R4, #4] \n"

"loc_FF8D79B4:\n"
"    CMP     R5, #1 \n"
"    LDRNEH  R0, [R8, #8] \n"
"    BNE     loc_FF8D79D0 \n"
"    LDRSH   R0, [R4, #0xC] \n"
"    LDR     R1, =0xFF8D64C8 \n"
"    MOV     R2, #0x20 \n"
"    BL      sub_FF8DC970 \n"

"loc_FF8D79D0:\n"
"    STRH    R0, [R4, #0xC] \n"
"    LDRSH   R0, [R4, #6] \n"
"    BL      sub_FF8C3364_my \n"  // --> Patched. Old value = 0xFF8C3364.
"    LDR     PC, =0xFF8D79DC \n"  // Continue in firmware
);
}

/*************************************************************/
//** sub_FF8C3364_my @ 0xFF8C3364 - 0xFF8C33D8, length=30
void __attribute__((naked,noinline)) sub_FF8C3364_my() {
asm volatile (
"    STMFD   SP!, {R4-R6,LR} \n"
"    LDR     R5, =0x3FBC \n"
"    MOV     R4, R0 \n"
"    LDR     R0, [R5, #4] \n"
"    CMP     R0, #1 \n"
"    LDRNE   R2, =0x16B \n"
"    LDRNE   R1, =0xFF8C3108 /*'Shutter.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"
"    CMN     R4, #0xC00 \n"
"    LDREQSH R4, [R5, #2] \n"
"    CMN     R4, #0xC00 \n"
"    LDREQ   R2, =0x171 \n"
"    LDREQ   R1, =0xFF8C3108 /*'Shutter.c'*/ \n"
"    MOVEQ   R0, #0 \n"
"    STRH    R4, [R5, #2] \n"
"    BLEQ    _DebugAssert \n"
"    MOV     R0, R4 \n"
"    BL      apex2us \n"  // --> Patched. Old value = _apex2us.
"    MOV     R4, R0 \n"
//"  BL      _sub_FF90C5D4 \n"  // --> Nullsub call removed.
"    MOV     R0, R4 \n"
"    BL      sub_FF90F658 \n"
"    TST     R0, #1 \n"
"    LDMEQFD SP!, {R4-R6,PC} \n"
"    LDMFD   SP!, {R4-R6,LR} \n"
"    LDR     R2, =0x176 \n"
"    LDR     R1, =0xFF8C3108 /*'Shutter.c'*/ \n"
"    MOV     R0, #0 \n"
"    B       _DebugAssert \n"
);
}
